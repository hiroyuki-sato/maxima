<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created by GNU Texinfo 5.1, http://www.gnu.org/software/texinfo/ -->
<head>
<title>Maxima 5.46.0 Manual: User defined operators</title>

<meta name="description" content="Maxima 5.46.0 Manual: User defined operators">
<meta name="keywords" content="Maxima 5.46.0 Manual: User defined operators">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link href="maxima_toc.html#Top" rel="start" title="Top">
<link href="maxima_307.html#Function-and-Variable-Index" rel="index" title="Function and Variable Index">
<link href="maxima_toc.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="maxima_33.html#Operators" rel="up" title="Operators">
<link href="maxima_41.html#Evaluation" rel="next" title="Evaluation">
<link href="maxima_39.html#Assignment-operators" rel="previous" title="Assignment operators">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.indentedblock {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smallindentedblock {margin-left: 3.2em; font-size: smaller}
div.smalllisp {margin-left: 3.2em}
kbd {font-style:oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nocodebreak {white-space:nowrap}
span.nolinebreak {white-space:nowrap}
span.roman {font-family:serif; font-weight:normal}
span.sansserif {font-family:sans-serif; font-weight:normal}
ul.no-bullet {list-style: none}
body {color: black; background: white;  margin-left: 8%; margin-right: 13%;
      font-family: "FreeSans", sans-serif}
h1 {font-size: 150%; font-family: "FreeSans", sans-serif}
h2 {font-size: 125%; font-family: "FreeSans", sans-serif}
h3 {font-size: 100%; font-family: "FreeSans", sans-serif}
a[href] {color: rgb(0,0,255); text-decoration: none;}
a[href]:hover {background: rgb(220,220,220);}
div.textbox {border: solid; border-width: thin; padding-top: 1em;
    padding-bottom: 1em; padding-left: 2em; padding-right: 2em}
div.titlebox {border: none; padding-top: 1em; padding-bottom: 1em;
    padding-left: 2em; padding-right: 2em; background: rgb(200,255,255);
    font-family: sans-serif}
div.synopsisbox {
    border: none; padding-top: 1em; padding-bottom: 1em; padding-left: 2em;
    padding-right: 2em; background: rgb(255,220,255);}
pre.example {border: 1px solid rgb(180,180,180); padding-top: 1em;
    padding-bottom: 1em; padding-left: 1em; padding-right: 1em;
    background-color: rgb(238,238,255)}
div.spacerbox {border: none; padding-top: 2em; padding-bottom: 2em}
div.image {margin: 0; padding: 1em; text-align: center}
div.categorybox {border: 1px solid gray; padding-top: 1em; padding-bottom: 1em;
    padding-left: 1em; padding-right: 1em; background: rgb(247,242,220)}
img {max-width:80%; max-height: 80%; display: block; margin-left: auto; margin-right: auto}

-->
</style>

<link rel="icon" href="figures/favicon.ico">

</head>

<body lang="ja" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">
<a name="User-defined-operators"></a>
<div class="header">
<p>
Previous: <a href="maxima_39.html#Assignment-operators" accesskey="p" rel="previous">Assignment operators</a>, Up: <a href="maxima_33.html#Operators" accesskey="u" rel="up">Operators</a> &nbsp; [<a href="maxima_toc.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="maxima_307.html#Function-and-Variable-Index" title="Index" rel="index">Index</a>]</p>
</div>
<a name="User-defined-operators-1"></a>
<h3 class="section">7.7 User defined operators</h3>

<a name="infix"></a><a name="Item_003a-Operators_002fdeffn_002finfix"></a><dl>
<dt><a name="index-infix"></a>関数: <strong>infix</strong> <em>(<var>op</var>)</em></dt>
<dt><a name="index-infix-1"></a>関数: <strong>infix</strong> <em>(<var>op</var>, <var>lbp</var>, <var>rbp</var>)</em></dt>
<dt><a name="index-infix-2"></a>関数: <strong>infix</strong> <em>(<var>op</var>, <var>lbp</var>, <var>rbp</var>, <var>lpos</var>, <var>rpos</var>, <var>pos</var>)</em></dt>
<dd>
<p><var>op</var>を中置演算子に宣言します。
中置演算子は２つの引数の関数で、引数の間に関数名が来ます。
例えば、引き算演算子<code>-</code>は中置演算子です。
</p>
<p><code>infix (<var>op</var>)</code>は、デフォルトの結合力（左右両方とも180）と品詞
（左右両方とも<code>any</code>)に等しい）で<var>op</var>を中置演算子に宣言します。
</p>
<p><code>infix (<var>op</var>, <var>lbp</var>, <var>rbp</var>)</code>は、
記述された左右の結合力
とデフォルトの品詞（左右両方とも<code>any</code>)に等しい）で、
<var>op</var>を中置演算子に宣言します。
</p>
<p><code>infix (<var>op</var>, <var>lbp</var>, <var>rbp</var>, <var>lpos</var>, <var>rpos</var>, <var>pos</var>)</code>は、
記述された左右の結合力と、
左オペランド、右オペランド、演算子結果それぞれについて、
品詞を<var>lpos</var>, <var>rpos</var>, <var>pos</var>に設定して、
<var>op</var>を中置演算子に宣言します。
</p>
<p>（演算子宣言に関係して）「品詞」は、式のタイプを意味します。
３つのタイプが認識されます; <code>expr</code>, <code>clause</code>, <code>any</code>。それぞれは、
代数式、ブーリアン式、任意の種類の式を示します。
Maximaは、宣言された品詞を実際の式に比較することで、
いくつかの構文法エラーを検出します。
</p>
<p>他の演算子に関する<var>op</var>の優先順位は、問題となっている演算子の左右結合力から演繹されます。
もし<var>op</var>の左右結合力のどちらもある他の演算子の左右結合力より大きいなら、
<var>op</var>は、他の演算子より高い優先順位をとります。
もし結合力がどちらも大きくも、どちらも小さくもなければ、
あるもっと複雑な関係が成り立ちます。
</p>
<p><var>op</var>の結合性は結合力に依存します。
より大きな左結合力(<var>lbp</var>)は、<var>op</var>のインスタンスが
式の中で左にある他の演算子の前に評価されることを示し、
より大きな右結合力(<var>rbp</var>)は、<var>op</var>のインスタンスが
式の中で右にある他の演算子の前に評価されることを示します。
このように、より大きな<var>lbp</var>は<var>op</var>を右結合にし、
より大きな<var>rbp</var>は<var>op</var>を左結合にします。
もし<var>lbp</var>が<var>rbp</var>と等しいなら、
<var>op</var>は左結合です。
</p>
<p><code>Syntax</code>も参照してください。
</p>
<p>例:
</p>
<p>もし<var>op</var>左右結合力それぞれが、他の演算子のそれより大きいなら、
<var>op</var>は他の演算子より高い優先順位をとります。
</p>
<div class="example">
<pre class="example">(%i1) :lisp (get '$+ 'lbp)
100
(%i1) :lisp (get '$+ 'rbp)
100
(%i1) infix (&quot;##&quot;, 101, 101);
(%o1)                          ##
(%i2) &quot;##&quot;(a, b) := sconcat(&quot;(&quot;, a, &quot;,&quot;, b, &quot;)&quot;);
(%o2)       (a ## b) := sconcat(&quot;(&quot;, a, &quot;,&quot;, b, &quot;)&quot;)
(%i3) 1 + a ## b + 2;
(%o3)                       (a,b) + 3
(%i4) infix (&quot;##&quot;, 99, 99);
(%o4)                          ##
(%i5) 1 + a ## b + 2;
(%o5)                       (a+1,b+2)
</pre></div>

<p>より大きな<var>lbp</var>は<var>op</var>を右結合にし、
より大きな<var>rbp</var>は<var>op</var>を左結合にします。
</p>
<div class="example">
<pre class="example">(%i1) infix (&quot;##&quot;, 100, 99);
(%o1)                          ##
(%i2) &quot;##&quot;(a, b) := sconcat(&quot;(&quot;, a, &quot;,&quot;, b, &quot;)&quot;)$
(%i3) foo ## bar ## baz;
(%o3)                    (foo,(bar,baz))
(%i4) infix (&quot;##&quot;, 100, 101);
(%o4)                          ##
(%i5) foo ## bar ## baz;
(%o5)                    ((foo,bar),baz)
</pre></div>

<p>Maximaは、宣言された品詞を実際の式と比較することで、
いくつかの構文法エラーを検出します。
</p>
<div class="example">
<pre class="example">(%i1) infix (&quot;##&quot;, 100, 99, expr, expr, expr);
(%o1)                          ##
(%i2) if x ## y then 1 else 0;
Incorrect syntax: Found algebraic expression where logical
expression expected
if x ## y then 
             ^
(%i2) infix (&quot;##&quot;, 100, 99, expr, expr, clause);
(%o2)                          ##
(%i3) if x ## y then 1 else 0;
(%o3)                if x ## y then 1 else 0
</pre></div>

<div class=categorybox>
<a href="maxima_311.html#Category_003a-Operators">Operators</a>
&middot;<a href="maxima_311.html#Category_003a-Declarations-and-inferences">Declarations and inferences</a>
&middot;<a href="maxima_311.html#Category_003a-Syntax">Syntax</a>
&middot;</div>
</dd></dl>

<a name="matchfix"></a><a name="Item_003a-Operators_002fdeffn_002fmatchfix"></a><dl>
<dt><a name="index-matchfix"></a>関数: <strong>matchfix</strong> <em>(<var>ldelimiter</var>, <var>rdelimiter</var>)</em></dt>
<dt><a name="index-matchfix-1"></a>関数: <strong>matchfix</strong> <em>(<var>ldelimiter</var>, <var>rdelimiter</var>, <var>arg_pos</var>, <var>pos</var>)</em></dt>
<dd>
<p>左と右の区切り記号<var>ldelimiter</var>と<var>rdelimiter</var>を持つ
matchfix演算子を宣言します
区切り記号は文字列として指定されます。
</p>
<p>&quot;matchfix&quot;演算子は、
任意の数の引数の関数で、引数は左と右の区切り記号をマッチする間で現れます。
パーサがオペランドや他の式や演算子から区切り記号を区別できる限り
区切り記号は任意の文字列を取り得ます。
実際には、これは、<code>%</code>, <code>,</code>, <code>$</code>, <code>;</code>のような
パースできない区切り記号を除外し、空白を持つ区切り記号を分離することを要求するかもしれません。
右区切り記号は、左区切り記号と同じかもしれませんし、違うかもしれません。
</p>
<p>左区切り記号は、たった１つの右区切り記号と関連づけられることができます;
２つの異なるmatchfix演算子は同じ左区切り記号を持つことはできません。
</p>
<p>存在する演算子は、
他のプロパティを変えることなく、
matchfix演算子として再宣言することができます。
特に、足し算<code>+</code>のような組み込み演算子が
matchfixに宣言されることが可能ですが、
演算子関数は組み込み演算子に関して定義できません。
</p>
<p>コマンド<code>matchfix (<var>ldelimiter</var>, <var>rdelimiter</var>, <var>arg_pos</var>,
<var>pos</var>)</code> は、
引数品詞<var>arg_pos</var>と結果品詞<var>pos</var>、区切り記号
<var>ldelimiter</var>と<var>rdelimiter</var>を宣言します。
</p>
<p>演算子宣言に関して、「品詞」は式のタイプを意味します。
３つのタイプが認識されます: 
それぞれ、代数式、ブーリアン式、任意の種類の式を示す、
<code>expr</code>, <code>clause</code>, <code>any</code>。
Maximaは、
宣言された品詞を実際の式と比較することで、
いくつかの構文法エラーを検知します。
</p>

<p>matchfix演算を実行する関数は通常のユーザー定義関数です。
演算子関数は、
関数定義演算子<code>:=</code>や<code>define</code>を使って
普通の方法で定義されます。
引数は、区切り記号の間に書かれるか、
クォートされた文字列としての左区切り記号と括弧の中で続く引数を使って書かれます。
<code>dispfun (<var>ldelimiter</var>)</code>は関数定義を表示します。
</p>
<p>唯一の組み込みmatchfix演算子はリスト構成子<code>[ ]</code>です。
括弧<code>( )</code>とダブルクォート<code>&quot; &quot;</code>はmatchfix演算子のように振る舞いますが、
Maximaパーサによってそのようには扱われません。
</p>
<p><code>matchfix</code>は引数を評価します。
<code>matchfix</code>は最初の引数<var>ldelimiter</var>を返します。
</p>
<p>例:
</p>
<p>区切り記号はほとんど任意の文字列を取り得ます。
</p>
<div class="example">
<pre class="example">(%i1) matchfix (&quot;@@&quot;, &quot;~&quot;);
(%o1)                          @@
(%i2) @@ a, b, c ~;
(%o2)                      @@a, b, c~
(%i3) matchfix (&quot;&gt;&gt;&quot;, &quot;&lt;&lt;&quot;);
(%o3)                          &gt;&gt;
(%i4) &gt;&gt; a, b, c &lt;&lt;;
(%o4)                      &gt;&gt;a, b, c&lt;&lt;
(%i5) matchfix (&quot;foo&quot;, &quot;oof&quot;);
(%o5)                          foo
(%i6) foo a, b, c oof;
(%o6)                     fooa, b, coof
(%i7) &gt;&gt; w + foo x, y oof + z &lt;&lt; / @@ p, q ~;
                     &gt;&gt;z + foox, yoof + w&lt;&lt;
(%o7)                ----------------------
                            @@p, q~
</pre></div>

<p>Matchfix演算子は通常のユーザー定義関数です。
</p>
<div class="example">
<pre class="example">(%i1) matchfix (&quot;!-&quot;, &quot;-!&quot;);
(%o1)                         &quot;!-&quot;
(%i2) !- x, y -! := x/y - y/x;
                                    x   y
(%o2)                   !-x, y-! := - - -
                                    y   x
(%i3) define (!-x, y-!, x/y - y/x);
                                    x   y
(%o3)                   !-x, y-! := - - -
                                    y   x
(%i4) define (&quot;!-&quot; (x, y), x/y - y/x);
                                    x   y
(%o4)                   !-x, y-! := - - -
                                    y   x
(%i5) dispfun (&quot;!-&quot;);
                                    x   y
(%t5)                   !-x, y-! := - - -
                                    y   x

(%o5)                         done
(%i6) !-3, 5-!;
                                16
(%o6)                         - --
                                15
(%i7) &quot;!-&quot; (3, 5);
                                16
(%o7)                         - --
                                15
</pre></div>

<div class=categorybox>
<a href="maxima_311.html#Category_003a-Syntax">Syntax</a>
&middot;<a href="maxima_311.html#Category_003a-Operators">Operators</a>
&middot;</div></dd></dl>

<a name="operator_005fnary"></a><a name="Item_003a-Operators_002fdeffn_002fnary"></a><dl>
<dt><a name="index-nary"></a>関数: <strong>nary</strong> <em>(<var>op</var>)</em></dt>
<dt><a name="index-nary-1"></a>関数: <strong>nary</strong> <em>(<var>op</var>, <var>bp</var>, <var>arg_pos</var>, <var>pos</var>)</em></dt>
<dd>
<p><code>nary</code>演算子は
任意の数の引数の関数を示すのに使われます。
引数それぞれは、例えば、A+BやA+B+Cように演算子の出現で分離されます。
<code>nary(&quot;x&quot;)</code>関数は
<code>x</code>を <code>nary</code>演算子に宣言する構文拡張関数です。
関数は <code>nary</code>であると宣言されるかもしれません。
もし <code>declare(j,nary);</code>が実行されたら、
これは整理器に
例えば、<code>j(j(a,b),j(c,d))</code>を <code>j(a, b, c, d)</code>に整理するよう指示します。
</p>
<p><a href="maxima_34.html#Introduction-to-operators">Introduction to operators</a>も参照してください。
</p>
<div class=categorybox>
<a href="maxima_311.html#Category_003a-Operators">Operators</a>
&middot;<a href="maxima_311.html#Category_003a-Syntax">Syntax</a>
&middot;</div></dd></dl>

<a name="nofix"></a><a name="Item_003a-Operators_002fdeffn_002fnofix"></a><dl>
<dt><a name="index-nofix"></a>関数: <strong>nofix</strong> <em>(<var>op</var>)</em></dt>
<dt><a name="index-nofix-1"></a>関数: <strong>nofix</strong> <em>(<var>op</var>, <var>pos</var>)</em></dt>
<dd>
<p><code>nofix</code>演算子は引数のない関数を示すのに使われます。
コマンドにそんな演算子が存在すると、
対応する関数が評価されるだけです。
例えば、Maximaブレイクから抜けるために&quot;exit;&quot;とタイプする時、
&quot;exit&quot;は<code>nofix</code>演算子と似たように振る舞います。
関数 <code>nofix(&quot;x&quot;)</code>は
<code>x</code>を <code>nofix</code>演算子に宣言する構文拡張関数です。
</p>
<p><a href="maxima_34.html#Introduction-to-operators">Introduction to operators</a>も参照してください。
</p>
<div class=categorybox>
<a href="maxima_311.html#Category_003a-Operators">Operators</a>
&middot;<a href="maxima_311.html#Category_003a-Syntax">Syntax</a>
&middot;</div></dd></dl>

<a name="postfix"></a><a name="Item_003a-Operators_002fdeffn_002fpostfix"></a><dl>
<dt><a name="index-postfix"></a>関数: <strong>postfix</strong> <em>(<var>op</var>)</em></dt>
<dt><a name="index-postfix-1"></a>関数: <strong>postfix</strong> <em>(<var>op</var>, <var>lbp</var>, <var>lpos</var>, <var>pos</var>)</em></dt>
<dd>
<p><code>prefix</code>変種のような<code>postfix</code>演算子は引数一つの関数を示しますが、
この場合、例えば3!のように、入力文字列の中で引数が演算子に先行します。
<code>postfix(&quot;x&quot;)</code>関数は <code>x</code>を<code>postfix</code>演算子に宣言する構文拡張関数です。
</p>
<p><a href="maxima_34.html#Introduction-to-operators">Introduction to operators</a>も参照してください。
</p>
<div class=categorybox>
<a href="maxima_311.html#Category_003a-Operators">Operators</a>
&middot;<a href="maxima_311.html#Category_003a-Syntax">Syntax</a>
&middot;</div></dd></dl>

<a name="prefix"></a><a name="Item_003a-Operators_002fdeffn_002fprefix"></a><dl>
<dt><a name="index-prefix"></a>関数: <strong>prefix</strong> <em>(<var>op</var>)</em></dt>
<dt><a name="index-prefix-1"></a>関数: <strong>prefix</strong> <em>(<var>op</var>, <var>rbp</var>, <var>rpos</var>, <var>pos</var>)</em></dt>
<dd>
<p><code>prefix</code>演算子は引数一つの関数であり、
その引数は演算子のすぐ後ろに置かれます。
<code>prefix(&quot;x&quot;)</code>は <code>x</code>を<code>prefix</code>演算子に宣言する構文拡張関数です。
</p>
<p><a href="maxima_34.html#Introduction-to-operators">Introduction to operators</a>も参照してください。
</p>
<div class=categorybox>
<a href="maxima_311.html#Category_003a-Operators">Operators</a>
&middot;<a href="maxima_311.html#Category_003a-Syntax">Syntax</a>
&middot;</div></dd></dl>

<hr>
<div class="header">
<p>
Previous: <a href="maxima_39.html#Assignment-operators" accesskey="p" rel="previous">Assignment operators</a>, Up: <a href="maxima_33.html#Operators" accesskey="u" rel="up">Operators</a> &nbsp; [<a href="maxima_toc.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="maxima_307.html#Function-and-Variable-Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
