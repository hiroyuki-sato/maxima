<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html401/loose.dtd">
<html>
<!-- Created on September, 20 2006 by texi2html 1.76 -->
<!--
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people <dev@texi2html.cvshome.org>
Send bugs and suggestions to <users@texi2html.cvshome.org>

-->
<head>
<title>Maxima Manual: 63. plotdf</title>

<meta name="description" content="Maxima Manual: 63. plotdf">
<meta name="keywords" content="Maxima Manual: 63. plotdf">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 1.76">
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.sansserif {font-family:sans-serif; font-weight:normal;}
ul.toc {list-style: none}
body
{
    color: black;
    background: white; 
    margin-left: 8%;
    margin-right: 13%;
}

h1
{
    margin-left: +8%;
    font-size: 150%;
    font-family: sans-serif
}

h2
{
    font-size: 125%;
    font-family: sans-serif
}

h3
{
    font-size: 100%;
    font-family: sans-serif
}

h2,h3,h4,h5,h6 { margin-left: +4%; }

div.textbox
{
    border: solid;
    border-width: thin;
    /* width: 100%; */
    padding-top: 1em;
    padding-bottom: 1em;
    padding-left: 2em;
    padding-right: 2em
}

div.titlebox
{
    border: none;
    padding-top: 1em;
    padding-bottom: 1em;
    padding-left: 2em;
    padding-right: 2em;
    background: rgb(200,255,255);
    font-family: sans-serif
}

div.synopsisbox
{
    border: none;
    padding-top: 1em;
    padding-bottom: 1em;
    padding-left: 2em;
    padding-right: 2em;
     background: rgb(255,220,255);
    /*background: rgb(200,255,255); */
    /* font-family: fixed */
}

pre.example
{
    border: none;
    padding-top: 1em;
    padding-bottom: 1em;
    padding-left: 1em;
    padding-right: 1em;
    background: rgb(247,242,180); /* kind of sandy */
    /* background: rgb(200,255,255); */ /* sky blue */
    font-family: "Lucida Console", monospace
}

div.spacerbox
{
    border: none;
    padding-top: 2em;
    padding-bottom: 2em
}

div.image
{
    margin: 0;
    padding: 1em;
    text-align: center;
}
-->
</style>

<link rel="icon" href="http://maxima.sourceforge.net/favicon.ico"/>
</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<a name="plotdf"></a>
<a name="SEC226"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="maxima_62.html#SEC225" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC227" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima_62.html#SEC217" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_64.html#SEC229" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_72.html#SEC264" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1 class="chapter"> 63. plotdf </h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#SEC227">63.1 Introduction to plotdf</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#SEC228">63.2 Definitions for plotdf</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr size="6">
<a name="Introduction-to-plotdf"></a>
<a name="SEC227"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC226" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC228" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC226" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC226" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_64.html#SEC229" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_72.html#SEC264" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 63.1 Introduction to plotdf </h2>

<p>The function <code>plotdf</code> creates a plot of the direction field of a
first-order Ordinary Differential Equation (ODE) or a system of two
autonomous first-order ODE's.
</p>
<p>To plot the direction field of a single ODE, the ODE must be written in
the form:
</p><table><tr><td>&nbsp;</td><td><pre class="example">       dy
       -- = F(x,y)
       dx
</pre></td></tr></table>
<p>and the function <var>F</var> should be given as the argument for
<code>plotdf</code>. The independent variable is always identified as <var>x</var>,
and the dependent variable as <var>y</var>. Those two variables should not
have any values assigned to them.
</p>
<p>To plot the direction field of a set of two autonomous ODE's, they must
be written in the form
</p><table><tr><td>&nbsp;</td><td><pre class="example">       dx             dy
       -- = G(x,y)    -- = F(x,y) 
       dt             dt
</pre></td></tr></table>
<p>and the argument for <code>plotdf</code> should be a list with the two
functions <var>F</var> and <var>G</var>, in any order.
</p>
<p>If only one ODE is given, <code>plotdf</code> will implicitly admit
<code>x=t</code>, and <code>G(x,y)=1</code>, transforming the non-autonomous
equation into a system of two autonomous equations.
</p>
<hr size="6">
<a name="Definitions-for-plotdf"></a>
<a name="SEC228"></a>
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC227" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima_64.html#SEC229" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC226" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SEC226" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="maxima_64.html#SEC229" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_72.html#SEC264" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section"> 63.2 Definitions for plotdf </h2>

<dl>
<dt><u>Function:</u> <b>plotdf</b><i> (<var>dydx</var>,...options...)</i>
<a name="IDX1830"></a>
</dt>
<dt><u>Function:</u> <b>plotdf</b><i> (<code>[</code><var>dxdt</var>,<var>dydt</var><code>]</code>,...options...)</i>
<a name="IDX1831"></a>
</dt>
<dd><p>Displays a direction field in two dimensions <var>x</var> and <var>y</var>.
</p>
<p><var>dydx</var>, <var>dxdt</var> and <var>dydt</var> are expressions that depend
on <var>x</var> and <var>y</var>. In addition to those two variables, the
expressions can also depend on a set of parameters, with numerical
values given with the <code>parameters</code> option (the option syntax is
given below), or with an range of allowed values specified by a
<var>sliders</var> option.
</p>
<p>Several other options can be given within the command, or entered into
the menu that will appear when the upper-left corner of the plot window
is clicked. Integral curves can be obtained by clicking on the plot, or
with the option <code>trajectory_at</code>. The direction of the integration
can be controlled with the <code>direction</code> option, which can have values
of &quot;forward&quot;, &quot;backward&quot; or &quot;both&quot;. The number of integration steps is
given by <code>nsteps</code> and the time interval between them is set up with
the <code>tstep</code> option. The Adams Moulton method is used for the
integration; it is also possible to switch to an adaptive Runge-Kutta
4th order method.
</p>
<p><b>Plot window menu:</b>
</p>
<p>The menu in the plot window has the following options: &quot;Zoom&quot;, will
change the behavior of the mouse so that it will allow you to zoom in
on a region of the plot by clicking with the left button. Each click
near a point magnifies the plot, keeping the center at the point where
you clicked. Holding the SHIFT key while clicking, zooms out to the
previous magnification. To resume computing trajectories when you
click on a point, select &quot;Integrate&quot; from the menu.
</p>
<p>The option &quot;Config&quot; in the menu can be used to change the ODE(s) in use
and various other settings. After configuration changes are made, the
menu option &quot;Replot&quot; should be selected, to activate the new settings.
If a pair of coordinates are entered in the field &quot;Trajectory at&quot; in the
&quot;Config&quot; dialog menu, and the &quot;enter&quot; key is pressed, a new integral
curve will be shown, in addition to the ones already shown. When
&quot;Replot&quot; is selected, only the last integral curve entered will be
shown.
</p>
<p>Holding the right mouse button down while the cursor is moved, can be
used to drag the plot sideways or up and down. Additional
parameters such as the number of steps, the initial value of <var>t</var>
and the x and y centers and radii, may be set in the Config menu.
</p>
<p>A copy of the plot can be printed to a Postscript printer, or saved as a
postscript file, using the menu option &quot;Save&quot;. To switch between
printing and saving to a Postscript file, &quot;Print Options&quot; should be
selected in the dialog window of &quot;Config&quot;. After the settings in the
&quot;Save&quot; dialog window are entered, &quot;Save&quot; must be selected in the first
menu, to create the file or print the plot.
</p>
<p><b>Plot options:</b>
</p>
<p>The <code>plotdf</code> command may include several commands, each command is
a list of two or more items.  The first item is the name of the option,
and the remainder comprises the value or values assigned to the option.
</p>
<p>The options which are recognized by <code>plotdf</code> are the following:
</p>
<ul>
<li>
Option: <code>tstep</code> defines the length of the increments on the
independent variable <var>t</var>, used to compute an integral curve. If only
one expression <var>dydx</var> is given to <code>plotdf</code>, the <var>x</var>
variable will be directly proportional to <var>t</var>: <code>x - xinitial =
t - tinitial</code>.
<table><tr><td>&nbsp;</td><td><pre class="example">[tstep,0.01]
</pre></td></tr></table><p>The default value is 0.1.
</p>
</li><li>
Option: <code>nsteps</code> defines the number of steps of length <code>tstep</code>
that will be used for the independent variable, to compute an integral
curve.
<table><tr><td>&nbsp;</td><td><pre class="example">[nsteps,500]
</pre></td></tr></table><p>The default value is 100.
</p>
</li><li>
Option: <code>direction</code> defines the direction of the independent
variable that will be followed to compute an integral curve. Possible
values are <code>forward</code>, to make the independent variable increase
<code>nsteps</code> times, with increments <code>tstep</code>, <code>backward</code>, to
make the independent variable decrease, or <code>both</code> that will lead to
an integral curve that extends <code>nsteps</code> forward, and <code>nsteps</code>
backward. The keywords <code>right</code> and <code>left</code> can be used as
synonyms for <code>forward</code> and <code>backward</code>.
<table><tr><td>&nbsp;</td><td><pre class="example">[direction,forward]
</pre></td></tr></table><p>The defaul value is <code>both</code>.
</p>
</li><li>
Option: <code>tinitial</code> defines the initial value of variable <var>t</var> used
to compute integral curves. Since the differential equations are
autonomous, that setting will only appear in the plot of the curves as
functions of <var>t</var>. 
<table><tr><td>&nbsp;</td><td><pre class="example">[tinitial,6.7]
</pre></td></tr></table><p>The default value is 0.
</p>
</li><li>
Option: <code>versus_t</code> is used to create a second plot window, with a
plot of an integral curve, as two functions <var>x</var>, <var>y</var>, of the
independent variable <var>t</var>. If <code>versus_t</code> is given any value
different from 0, the second plot window will be displayed. The second
plot window includes another menu, similar to the menu of the main plot
window.
<table><tr><td>&nbsp;</td><td><pre class="example">[versus_t,1]
</pre></td></tr></table><p>The default value is 0.
</p>
</li><li>
Option: <code>trajectory_at</code> defines the coordinates <var>xinitial</var> and
<var>yinitial</var> for the starting point of an integral curve.
<table><tr><td>&nbsp;</td><td><pre class="example">[trajectory_at,0.1,3.2]
</pre></td></tr></table><p>The option is empty by default.
</p>
</li><li>
Option <code>parameters</code> defines a list of parameters, and their
numerical values, used in the definition of the differential
equations. The name and values of the parameters must be given in a
string with a comma-separated sequence of pairs <code>name=value</code>.
<table><tr><td>&nbsp;</td><td><pre class="example">[parameters,&quot;k=1.1,m=2.5&quot;]
</pre></td></tr></table>
</li><li>
Option: <code>sliders</code> defines a list o parameters that will be changed
interactively using slider buttons, and the range of variation of those
parameters. The names and ranges of the parameters must be given in a
string with a comma-separated sequence of elements <code>name=min:max</code>
<table><tr><td>&nbsp;</td><td><pre class="example">[sliders,&quot;k=0:4,m=1:3&quot;]
</pre></td></tr></table>
</li><li>
Option: <code>xfun</code> defines a string with semi-colon-separated sequence
of functions of <var>x</var> to be displayed, on top of the direction field.
Those functions will be parsed by Tcl and not by Maxima.
<table><tr><td>&nbsp;</td><td><pre class="example">[xfun,&quot;x^2;sin(x);exp(x)&quot;]
</pre></td></tr></table>
</li><li>
Option: <code>xradius</code> is half of the length of the range of values that
will be shown in the x direction.
<table><tr><td>&nbsp;</td><td><pre class="example">[xradius,12.5]
</pre></td></tr></table><p>the default value is 10.
</p>
</li><li>
Option: <code>yradius</code> is half of the length of the range of values that
will be shown in the y direction.
<table><tr><td>&nbsp;</td><td><pre class="example">[yradius,15]
</pre></td></tr></table><p>the default value is 10.
</p>
</li><li>
Option: <code>xcenter</code> is the x coordinate of the point at the center of
the plot.
<table><tr><td>&nbsp;</td><td><pre class="example">[xcenter,3.45]
</pre></td></tr></table><p>The default value is 0.
</p>
</li><li>
Option: <code>ycenter</code> is the y coordinate of the point at the center of
the plot.
<table><tr><td>&nbsp;</td><td><pre class="example">[ycenter,4.5]
</pre></td></tr></table><p>The default value is 0.
</p>
</li><li>
Option: <code>width</code> defines the width of the plot window, in pixels.
<table><tr><td>&nbsp;</td><td><pre class="example">[width,800]
</pre></td></tr></table><p>The default value is 500.
</p>
</li><li>
Option: <code>height</code> defines the height of the plot window, in pixels.
<table><tr><td>&nbsp;</td><td><pre class="example">[width,600]
</pre></td></tr></table><p>The default value is 500.
</p></li></ul>

<p><b>Examples:</b>
</p>
<p>NOTE: Due to a bug in <code>openmath</code>, all commands that use it, in particular
<code>plotdf</code>, must end with a semicolon and not with a dollar sign. The
dollar sign might work in some of the graphical interfaces to Maxima, but
to avoid problems we will use a semicolon in all the examples below.
</p>  
<ul>
<li>
To show the direction field of the differential equation <em>y' = exp(-x) + y</em> and the solution that goes through <em>(2, -0.1)</em>:
<table><tr><td>&nbsp;</td><td><pre class="example">(%i1) load(&quot;plotdf&quot;)$

(%i2) plotdf(exp(-x)+y,[trajectory_at,2,-0.1]);
</pre></td></tr></table>
<p><div class="image"><img src="./figures/plotdf1.gif" alt="figures/plotdf1"></div>
</p>
</li><li>
To obtain the direction field for the equation <em>diff(y,x) = x - y^2</em> and the solution with initial condition <em>y(-1) = 3</em>, we can use the command:
<table><tr><td>&nbsp;</td><td><pre class="example">(%i3) plotdf(x-y^2,[xfun,&quot;sqrt(x);-sqrt(x)&quot;],
          [trajectory_at,-1,3], [direction,forward],
          [yradius,5],[xcenter,6]);
</pre></td></tr></table><p>The graph also shows the function <em>y = sqrt(x)</em>. 
</p>
<p><div class="image"><img src="./figures/plotdf2.gif" alt="figures/plotdf2"></div>
</p>
</li><li>
The following example shows the direction field of a harmonic oscillator,
defined by the two equations <em>dx/dt = y</em> and <em>dy/dt = -k*x/m</em>,
and the integral curve through <em>(x,y) = (6,0)</em>, with a slider that
will allow you to change the value of <em>m</em> interactively (<em>k</em> is
fixed at 2):
<table><tr><td>&nbsp;</td><td><pre class="example">(%i4) plotdf([y,-k*x/m],[parameters,&quot;m=2,k=2&quot;],
            [sliders,&quot;m=1:5&quot;], [trajectory_at,6,0]);
</pre></td></tr></table>
<p><div class="image"><img src="./figures/plotdf3.gif" alt="figures/plotdf3"></div>
</p>
</li><li>
To plot the direction field of the Duffing equation, <em>m*x&quot;+c*x'+k*x+b*x^3 = 0</em>, we introduce the variable <em>y=x'</em> and use:
<table><tr><td>&nbsp;</td><td><pre class="example">(%i5) plotdf([y,-(k*x + c*y + b*x^3)/m],
              [parameters,&quot;k=-1,m=1.0,c=0,b=1&quot;],
              [sliders,&quot;k=-2:2,m=-1:1&quot;],[tstep,0.1]);
</pre></td></tr></table>
<p><div class="image"><img src="./figures/plotdf4.gif" alt="figures/plotdf4"></div>
</p>
</li><li>
The direction field for a damped pendulum, including the
solution for the given initial conditions, with a slider that
can be used to change the value of the mass <em>m</em>, and with a plot of
the two state variables as a function of time:

<table><tr><td>&nbsp;</td><td><pre class="example">(%i6) plotdf([y,-g*sin(x)/l - b*y/m/l],
         [parameters,&quot;g=9.8,l=0.5,m=0.3,b=0.05&quot;],
         [trajectory_at,1.05,-9],[tstep,0.01],
         [xradius,6],[yradius,14],
         [xcenter,-4],[direction,forward],[nsteps,300],
         [sliders,&quot;m=0.1:1&quot;], [versus_t,1]);
</pre></td></tr></table>
<p><div class="image"><img src="./figures/plotdf5.gif" alt="figures/plotdf5"></div><div class="image"><img src="./figures/plotdf6.gif" alt="figures/plotdf6"></div>
</p>
</li></ul>

<p>To use this function write first <code>load(&quot;plotdf&quot;)</code>.
</p></dd></dl>


<hr size="6">
<table cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#SEC226" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="maxima_64.html#SEC229" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="maxima.html#SEC_Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="maxima_toc.html#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="maxima_72.html#SEC264" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="maxima_abt.html#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<p>
 <font size="-1">
  This document was generated by <em>Robert Dodier</em> on <em>September, 20 2006</em> using <a href="http://texi2html.cvshome.org/"><em>texi2html 1.76</em></a>.
 </font>
 <br>

</p>
</body>
</html>
