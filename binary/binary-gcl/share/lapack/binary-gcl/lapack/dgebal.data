       
#(#! 
(lisp::in-package :lapack)#! 
(lisp::in-package "CL-USER")
#((system::%init . #((lisp::let* ((lapack::zero 0.0F0) (lapack::one 1.0F0) (lapack::sclfac 8.0F0) (lapack::factor 0.94999999999999996F0)) (lisp::declare (lisp::type (lisp::double-float 0.0F0 0.0F0) lapack::zero) (lisp::type (lisp::double-float 1.0F0 1.0F0) lapack::one) (lisp::type (lisp::double-float 8.0F0 8.0F0) lapack::sclfac) (lisp::type (lisp::double-float 0.94999999999999996F0 0.94999999999999996F0) lapack::factor) (lisp::ignorable lapack::zero lapack::one lapack::sclfac lapack::factor)) (lisp::defun lapack::dgebal (lapack::job lapack::n lapack::a lapack::lda lapack::ilo lapack::ihi lapack::scale lapack::info) (lisp::declare (lisp::type (lisp::array lisp::double-float (lisp::*)) lapack::scale lapack::a) (lisp::type (f2cl-lib::integer4) lapack::info lapack::ihi lapack::ilo lapack::lda lapack::n) (lisp::type (lisp::simple-array lisp::character (lisp::*)) lapack::job)) (f2cl-lib::with-multi-array-data ((lapack::job lisp::character lapack::job-%data% lapack::job-%offset%) (lapack::a lisp::double-float lapack::a-%data% lapack::a-%offset%) (lapack::scale lisp::double-float lapack::scale-%data% lapack::scale-%offset%)) (lisp::prog ((lapack::c 0.0F0) (lapack::ca 0.0F0) (lapack::f 0.0F0) (lapack::g 0.0F0) (lapack::r 0.0F0) (lapack::ra 0.0F0) (lapack::s 0.0F0) (lapack::sfmax1 0.0F0) (lapack::sfmax2 0.0F0) (lapack::sfmin1 0.0F0) (lapack::sfmin2 0.0F0) (lapack::i 0) (lapack::ica 0) (lapack::iexc 0) (lapack::ira 0) (lapack::j 0) (lapack::k 0) (lapack::l 0) (lapack::m 0) (lapack::noconv lisp::nil)) (lisp::declare (lisp::type (lisp::double-float) lapack::c lapack::ca lapack::f lapack::g lapack::r lapack::ra lapack::s lapack::sfmax1 lapack::sfmax2 lapack::sfmin1 lapack::sfmin2) (lisp::type (f2cl-lib::integer4) lapack::i lapack::ica lapack::iexc lapack::ira lapack::j lapack::k lapack::l lapack::m) (lisp::type f2cl-lib::logical lapack::noconv)) (lisp::setf lapack::info 0) (lisp::cond ((lisp::and (lisp::not (blas::lsame lapack::job "N")) (lisp::not (blas::lsame lapack::job "P")) (lisp::not (blas::lsame lapack::job "S")) (lisp::not (blas::lsame lapack::job "B"))) (lisp::setf lapack::info -1)) ((lisp::< lapack::n 0) (lisp::setf lapack::info -2)) ((lisp::< lapack::lda (lisp::max (lisp::the f2cl-lib::integer4 1) (lisp::the f2cl-lib::integer4 lapack::n))) (lisp::setf lapack::info -4))) (lisp::cond ((lisp::/= lapack::info 0) (blas::xerbla "DGEBAL" (f2cl-lib::int-sub lapack::info)) (lisp::go lapack::end_label))) (lisp::setf lapack::k 1) (lisp::setf lapack::l lapack::n) (lisp::if (lisp::= lapack::n 0) (lisp::go lapack::label210)) (lisp::cond ((blas::lsame lapack::job "N") (f2cl-lib::fdo (lapack::i 1 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::n) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::scale-%data% (lapack::i) ((1 lisp::*)) lapack::scale-%offset%) lapack::one) lapack::label10)) (lisp::go lapack::label210))) (lisp::if (blas::lsame lapack::job "S") (lisp::go lapack::label120)) (lisp::go lapack::label50) lapack::label20 (lisp::setf (f2cl-lib::fref lapack::scale-%data% (lapack::m) ((1 lisp::*)) lapack::scale-%offset%) (lisp::coerce (lisp::the f2cl-lib::integer4 lapack::j) (lisp::quote lisp::double-float))) (lisp::if (lisp::= lapack::j lapack::m) (lisp::go lapack::label30)) (blas::dswap lapack::l (f2cl-lib::array-slice lapack::a lisp::double-float (1 lapack::j) ((1 lapack::lda) (1 lisp::*))) 1 (f2cl-lib::array-slice lapack::a lisp::double-float (1 lapack::m) ((1 lapack::lda) (1 lisp::*))) 1) (blas::dswap (f2cl-lib::int-add (f2cl-lib::int-sub lapack::n lapack::k) 1) (f2cl-lib::array-slice lapack::a lisp::double-float (lapack::j lapack::k) ((1 lapack::lda) (1 lisp::*))) lapack::lda (f2cl-lib::array-slice lapack::a lisp::double-float (lapack::m lapack::k) ((1 lapack::lda) (1 lisp::*))) lapack::lda) lapack::label30 (f2cl-lib::computed-goto (lapack::label40 lapack::label80) lapack::iexc) lapack::label40 (lisp::if (lisp::= lapack::l 1) (lisp::go lapack::label210)) (lisp::setf lapack::l (f2cl-lib::int-sub lapack::l 1)) lapack::label50 (f2cl-lib::fdo (lapack::j lapack::l (f2cl-lib::int-add lapack::j (f2cl-lib::int-sub 1))) ((lisp::> lapack::j 1) lisp::nil) (lisp::tagbody (f2cl-lib::fdo (lapack::i 1 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::l) lisp::nil) (lisp::tagbody (lisp::if (lisp::= lapack::i lapack::j) (lisp::go lapack::label60)) (lisp::if (lisp::/= (f2cl-lib::fref lapack::a-%data% (lapack::j lapack::i) ((1 lapack::lda) (1 lisp::*)) lapack::a-%offset%) lapack::zero) (lisp::go lapack::label70)) lapack::label60)) (lisp::setf lapack::m lapack::l) (lisp::setf lapack::iexc 1) (lisp::go lapack::label20) lapack::label70)) (lisp::go lapack::label90) lapack::label80 (lisp::setf lapack::k (f2cl-lib::int-add lapack::k 1)) lapack::label90 (f2cl-lib::fdo (lapack::j lapack::k (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j lapack::l) lisp::nil) (lisp::tagbody (f2cl-lib::fdo (lapack::i lapack::k (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::l) lisp::nil) (lisp::tagbody (lisp::if (lisp::= lapack::i lapack::j) (lisp::go lapack::label100)) (lisp::if (lisp::/= (f2cl-lib::fref lapack::a-%data% (lapack::i lapack::j) ((1 lapack::lda) (1 lisp::*)) lapack::a-%offset%) lapack::zero) (lisp::go lapack::label110)) lapack::label100)) (lisp::setf lapack::m lapack::k) (lisp::setf lapack::iexc 2) (lisp::go lapack::label20) lapack::label110)) lapack::label120 (f2cl-lib::fdo (lapack::i lapack::k (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::l) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::scale-%data% (lapack::i) ((1 lisp::*)) lapack::scale-%offset%) lapack::one) lapack::label130)) (lisp::if (blas::lsame lapack::job "P") (lisp::go lapack::label210)) (lisp::setf lapack::sfmin1 (lisp::/ (lapack::dlamch "S") (lapack::dlamch "P"))) (lisp::setf lapack::sfmax1 (lisp::/ lapack::one lapack::sfmin1)) (lisp::setf lapack::sfmin2 (lisp::* lapack::sfmin1 lapack::sclfac)) (lisp::setf lapack::sfmax2 (lisp::/ lapack::one lapack::sfmin2)) lapack::label140 (lisp::setf lapack::noconv f2cl-lib::%false%) (f2cl-lib::fdo (lapack::i lapack::k (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::l) lisp::nil) (lisp::tagbody (lisp::setf lapack::c lapack::zero) (lisp::setf lapack::r lapack::zero) (f2cl-lib::fdo (lapack::j lapack::k (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j lapack::l) lisp::nil) (lisp::tagbody (lisp::if (lisp::= lapack::j lapack::i) (lisp::go lapack::label150)) (lisp::setf lapack::c (lisp::+ lapack::c (lisp::abs (f2cl-lib::fref lapack::a-%data% (lapack::j lapack::i) ((1 lapack::lda) (1 lisp::*)) lapack::a-%offset%)))) (lisp::setf lapack::r (lisp::+ lapack::r (lisp::abs (f2cl-lib::fref lapack::a-%data% (lapack::i lapack::j) ((1 lapack::lda) (1 lisp::*)) lapack::a-%offset%)))) lapack::label150)) (lisp::setf lapack::ica (blas::idamax lapack::l (f2cl-lib::array-slice lapack::a lisp::double-float (1 lapack::i) ((1 lapack::lda) (1 lisp::*))) 1)) (lisp::setf lapack::ca (lisp::abs (f2cl-lib::fref lapack::a-%data% (lapack::ica lapack::i) ((1 lapack::lda) (1 lisp::*)) lapack::a-%offset%))) (lisp::setf lapack::ira (blas::idamax (f2cl-lib::int-add (f2cl-lib::int-sub lapack::n lapack::k) 1) (f2cl-lib::array-slice lapack::a lisp::double-float (lapack::i lapack::k) ((1 lapack::lda) (1 lisp::*))) lapack::lda)) (lisp::setf lapack::ra (lisp::abs (f2cl-lib::fref lapack::a-%data% (lapack::i (f2cl-lib::int-sub (f2cl-lib::int-add lapack::ira lapack::k) 1)) ((1 lapack::lda) (1 lisp::*)) lapack::a-%offset%))) (lisp::if (lisp::or (lisp::= lapack::c lapack::zero) (lisp::= lapack::r lapack::zero)) (lisp::go lapack::label200)) (lisp::setf lapack::g (lisp::/ lapack::r lapack::sclfac)) (lisp::setf lapack::f lapack::one) (lisp::setf lapack::s (lisp::+ lapack::c lapack::r)) lapack::label160 (lisp::if (lisp::or (lisp::>= lapack::c lapack::g) (lisp::>= (lisp::max lapack::f lapack::c lapack::ca) lapack::sfmax2) (lisp::<= (lisp::min lapack::r lapack::g lapack::ra) lapack::sfmin2)) (lisp::go lapack::label170)) (lisp::setf lapack::f (lisp::* lapack::f lapack::sclfac)) (lisp::setf lapack::c (lisp::* lapack::c lapack::sclfac)) (lisp::setf lapack::ca (lisp::* lapack::ca lapack::sclfac)) (lisp::setf lapack::r (lisp::/ lapack::r lapack::sclfac)) (lisp::setf lapack::g (lisp::/ lapack::g lapack::sclfac)) (lisp::setf lapack::ra (lisp::/ lapack::ra lapack::sclfac)) (lisp::go lapack::label160) lapack::label170 (lisp::setf lapack::g (lisp::/ lapack::c lapack::sclfac)) lapack::label180 (lisp::if (lisp::or (lisp::< lapack::g lapack::r) (lisp::>= (lisp::max lapack::r lapack::ra) lapack::sfmax2) (lisp::<= (lisp::min lapack::f lapack::c lapack::g lapack::ca) lapack::sfmin2)) (lisp::go lapack::label190)) (lisp::setf lapack::f (lisp::/ lapack::f lapack::sclfac)) (lisp::setf lapack::c (lisp::/ lapack::c lapack::sclfac)) (lisp::setf lapack::g (lisp::/ lapack::g lapack::sclfac)) (lisp::setf lapack::ca (lisp::/ lapack::ca lapack::sclfac)) (lisp::setf lapack::r (lisp::* lapack::r lapack::sclfac)) (lisp::setf lapack::ra (lisp::* lapack::ra lapack::sclfac)) (lisp::go lapack::label180) lapack::label190 (lisp::if (lisp::>= (lisp::+ lapack::c lapack::r) (lisp::* lapack::factor lapack::s)) (lisp::go lapack::label200)) (lisp::cond ((lisp::and (lisp::< lapack::f lapack::one) (lisp::< (f2cl-lib::fref lapack::scale (lapack::i) ((1 lisp::*))) lapack::one)) (lisp::if (lisp::<= (lisp::* lapack::f (f2cl-lib::fref lapack::scale-%data% (lapack::i) ((1 lisp::*)) lapack::scale-%offset%)) lapack::sfmin1) (lisp::go lapack::label200)))) (lisp::cond ((lisp::and (lisp::> lapack::f lapack::one) (lisp::> (f2cl-lib::fref lapack::scale (lapack::i) ((1 lisp::*))) lapack::one)) (lisp::if (lisp::>= (f2cl-lib::fref lapack::scale-%data% (lapack::i) ((1 lisp::*)) lapack::scale-%offset%) (lisp::/ lapack::sfmax1 lapack::f)) (lisp::go lapack::label200)))) (lisp::setf lapack::g (lisp::/ lapack::one lapack::f)) (lisp::setf (f2cl-lib::fref lapack::scale-%data% (lapack::i) ((1 lisp::*)) lapack::scale-%offset%) (lisp::* (f2cl-lib::fref lapack::scale-%data% (lapack::i) ((1 lisp::*)) lapack::scale-%offset%) lapack::f)) (lisp::setf lapack::noconv f2cl-lib::%true%) (blas::dscal (f2cl-lib::int-add (f2cl-lib::int-sub lapack::n lapack::k) 1) lapack::g (f2cl-lib::array-slice lapack::a lisp::double-float (lapack::i lapack::k) ((1 lapack::lda) (1 lisp::*))) lapack::lda) (blas::dscal lapack::l lapack::f (f2cl-lib::array-slice lapack::a lisp::double-float (1 lapack::i) ((1 lapack::lda) (1 lisp::*))) 1) lapack::label200)) (lisp::if lapack::noconv (lisp::go lapack::label140)) lapack::label210 (lisp::setf lapack::ilo lapack::k) (lisp::setf lapack::ihi lapack::l) (lisp::go lapack::end_label) lapack::end_label (lisp::return (lisp::values lisp::nil lisp::nil lisp::nil lisp::nil lapack::ilo lapack::ihi lisp::nil lapack::info)))))))))
)
