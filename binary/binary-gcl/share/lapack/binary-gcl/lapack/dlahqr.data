       
#(#! 
(lisp::in-package :lapack)#! 
(lisp::in-package "CL-USER")
#((system::%init . #((lisp::let* ((lapack::zero 0.0F0) (lapack::one 1.0F0) (lapack::half 0.5F0) (lapack::dat1 0.75F0) (lapack::dat2 (lisp::- 0.4375F0))) (lisp::declare (lisp::type (lisp::double-float 0.0F0 0.0F0) lapack::zero) (lisp::type (lisp::double-float 1.0F0 1.0F0) lapack::one) (lisp::type (lisp::double-float 0.5F0 0.5F0) lapack::half) (lisp::type (lisp::double-float 0.75F0 0.75F0) lapack::dat1) (lisp::type (lisp::double-float) lapack::dat2) (lisp::ignorable lapack::zero lapack::one lapack::half lapack::dat1 lapack::dat2)) (lisp::defun lapack::dlahqr (lapack::wantt lapack::wantz lapack::n lapack::ilo lapack::ihi lapack::h lapack::ldh lapack::wr lapack::wi lapack::iloz lapack::ihiz lapack::z lapack::ldz lapack::info) (lisp::declare (lisp::type (lisp::array lisp::double-float (lisp::*)) lapack::z lapack::wi lapack::wr lapack::h) (lisp::type (f2cl-lib::integer4) lapack::info lapack::ldz lapack::ihiz lapack::iloz lapack::ldh lapack::ihi lapack::ilo lapack::n) (lisp::type f2cl-lib::logical lapack::wantz lapack::wantt)) (f2cl-lib::with-multi-array-data ((lapack::h lisp::double-float lapack::h-%data% lapack::h-%offset%) (lapack::wr lisp::double-float lapack::wr-%data% lapack::wr-%offset%) (lapack::wi lisp::double-float lapack::wi-%data% lapack::wi-%offset%) (lapack::z lisp::double-float lapack::z-%data% lapack::z-%offset%)) (lisp::prog ((lapack::v (lisp::make-array 3 :element-type (lisp::quote lisp::double-float))) (lapack::work (lisp::make-array 1 :element-type (lisp::quote lisp::double-float))) (lapack::ave 0.0F0) (lapack::cs 0.0F0) (lapack::disc 0.0F0) (lapack::h00 0.0F0) (lapack::h10 0.0F0) (lapack::h11 0.0F0) (lapack::h12 0.0F0) (lapack::h21 0.0F0) (lapack::h22 0.0F0) (lapack::h33 0.0F0) (lapack::h33s 0.0F0) (lapack::h43h34 0.0F0) (lapack::h44 0.0F0) (lapack::h44s 0.0F0) (lapack::ovfl 0.0F0) (lapack::s 0.0F0) (lapack::smlnum 0.0F0) (lapack::sn 0.0F0) (lapack::sum 0.0F0) (lapack::t1 0.0F0) (lapack::t2 0.0F0) (lapack::t3 0.0F0) (lapack::tst1 0.0F0) (lapack::ulp 0.0F0) (lapack::unfl 0.0F0) (lapack::v1 0.0F0) (lapack::v2 0.0F0) (lapack::v3 0.0F0) (lapack::i 0) (lapack::i1 0) (lapack::i2 0) (lapack::itn 0) (lapack::its 0) (lapack::j 0) (lapack::k 0) (lapack::l 0) (lapack::m 0) (lapack::nh 0) (lapack::nr 0) (lapack::nz 0)) (lisp::declare (lisp::type (lisp::array lisp::double-float (3)) lapack::v) (lisp::type (lisp::array lisp::double-float (1)) lapack::work) (lisp::type (lisp::double-float) lapack::ave lapack::cs lapack::disc lapack::h00 lapack::h10 lapack::h11 lapack::h12 lapack::h21 lapack::h22 lapack::h33 lapack::h33s lapack::h43h34 lapack::h44 lapack::h44s lapack::ovfl lapack::s lapack::smlnum lapack::sn lapack::sum lapack::t1 lapack::t2 lapack::t3 lapack::tst1 lapack::ulp lapack::unfl lapack::v1 lapack::v2 lapack::v3) (lisp::type (f2cl-lib::integer4) lapack::i lapack::i1 lapack::i2 lapack::itn lapack::its lapack::j lapack::k lapack::l lapack::m lapack::nh lapack::nr lapack::nz)) (lisp::setf lapack::info 0) (lisp::if (lisp::= lapack::n 0) (lisp::go lapack::end_label)) (lisp::cond ((lisp::= lapack::ilo lapack::ihi) (lisp::setf (f2cl-lib::fref lapack::wr-%data% (lapack::ilo) ((1 lisp::*)) lapack::wr-%offset%) (f2cl-lib::fref lapack::h-%data% (lapack::ilo lapack::ilo) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf (f2cl-lib::fref lapack::wi-%data% (lapack::ilo) ((1 lisp::*)) lapack::wi-%offset%) lapack::zero) (lisp::go lapack::end_label))) (lisp::setf lapack::nh (f2cl-lib::int-add (f2cl-lib::int-sub lapack::ihi lapack::ilo) 1)) (lisp::setf lapack::nz (f2cl-lib::int-add (f2cl-lib::int-sub lapack::ihiz lapack::iloz) 1)) (lisp::setf lapack::unfl (lapack::dlamch "Safe minimum")) (lisp::setf lapack::ovfl (lisp::/ lapack::one lapack::unfl)) (lisp::multiple-value-bind (lapack::var-0 lapack::var-1) (lapack::dlabad lapack::unfl lapack::ovfl) (lisp::declare (lisp::ignore)) (lisp::setf lapack::unfl lapack::var-0) (lisp::setf lapack::ovfl lapack::var-1)) (lisp::setf lapack::ulp (lapack::dlamch "Precision")) (lisp::setf lapack::smlnum (lisp::* lapack::unfl (lisp::/ lapack::nh lapack::ulp))) (lisp::cond (lapack::wantt (lisp::setf lapack::i1 1) (lisp::setf lapack::i2 lapack::n))) (lisp::setf lapack::itn (f2cl-lib::int-mul 30 lapack::nh)) (lisp::setf lapack::i lapack::ihi) lapack::label10 (lisp::setf lapack::l lapack::ilo) (lisp::if (lisp::< lapack::i lapack::ilo) (lisp::go lapack::label150)) (f2cl-lib::fdo (lapack::its 0 (f2cl-lib::int-add lapack::its 1)) ((lisp::> lapack::its lapack::itn) lisp::nil) (lisp::tagbody (f2cl-lib::fdo (lapack::k lapack::i (f2cl-lib::int-add lapack::k (f2cl-lib::int-sub 1))) ((lisp::> lapack::k (f2cl-lib::int-add lapack::l 1)) lisp::nil) (lisp::tagbody (lisp::setf lapack::tst1 (lisp::+ (lisp::abs (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-sub lapack::k 1) (f2cl-lib::int-sub lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::abs (f2cl-lib::fref lapack::h-%data% (lapack::k lapack::k) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)))) (lisp::if (lisp::= lapack::tst1 lapack::zero) (lisp::setf lapack::tst1 (lapack::dlanhs "1" (f2cl-lib::int-add (f2cl-lib::int-sub lapack::i lapack::l) 1) (f2cl-lib::array-slice lapack::h lisp::double-float (lapack::l lapack::l) ((1 lapack::ldh) (1 lisp::*))) lapack::ldh lapack::work))) (lisp::if (lisp::<= (lisp::abs (f2cl-lib::fref lapack::h-%data% (lapack::k (f2cl-lib::int-sub lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::max (lisp::* lapack::ulp lapack::tst1) lapack::smlnum)) (lisp::go lapack::label30)) lapack::label20)) lapack::label30 (lisp::setf lapack::l lapack::k) (lisp::cond ((lisp::> lapack::l lapack::ilo) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::l (f2cl-lib::int-sub lapack::l 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) lapack::zero))) (lisp::if (lisp::>= lapack::l (f2cl-lib::int-sub lapack::i 1)) (lisp::go lapack::label140)) (lisp::cond ((lisp::not lapack::wantt) (lisp::setf lapack::i1 lapack::l) (lisp::setf lapack::i2 lapack::i))) (lisp::cond ((lisp::or (lisp::= lapack::its 10) (lisp::= lapack::its 20)) (lisp::setf lapack::s (lisp::+ (lisp::abs (f2cl-lib::fref lapack::h-%data% (lapack::i (f2cl-lib::int-sub lapack::i 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::abs (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-sub lapack::i 1) (f2cl-lib::int-sub lapack::i 2)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)))) (lisp::setf lapack::h44 (lisp::+ (lisp::* lapack::dat1 lapack::s) (f2cl-lib::fref lapack::h-%data% (lapack::i lapack::i) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%))) (lisp::setf lapack::h33 lapack::h44) (lisp::setf lapack::h43h34 (lisp::* lapack::dat2 lapack::s lapack::s))) (lisp::t (lisp::setf lapack::h44 (f2cl-lib::fref lapack::h-%data% (lapack::i lapack::i) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf lapack::h33 (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-sub lapack::i 1) (f2cl-lib::int-sub lapack::i 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf lapack::h43h34 (lisp::* (f2cl-lib::fref lapack::h-%data% (lapack::i (f2cl-lib::int-sub lapack::i 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-sub lapack::i 1) lapack::i) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%))) (lisp::setf lapack::s (lisp::* (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-sub lapack::i 1) (f2cl-lib::int-sub lapack::i 2)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-sub lapack::i 1) (f2cl-lib::int-sub lapack::i 2)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%))) (lisp::setf lapack::disc (lisp::* (lisp::- lapack::h33 lapack::h44) lapack::half)) (lisp::setf lapack::disc (lisp::+ (lisp::* lapack::disc lapack::disc) lapack::h43h34)) (lisp::cond ((lisp::> lapack::disc lapack::zero) (lisp::setf lapack::disc (f2cl-lib::fsqrt lapack::disc)) (lisp::setf lapack::ave (lisp::* lapack::half (lisp::+ lapack::h33 lapack::h44))) (lisp::cond ((lisp::> (lisp::+ (lisp::abs lapack::h33) (lisp::- (lisp::abs lapack::h44))) lapack::zero) (lisp::setf lapack::h33 (lisp::- (lisp::* lapack::h33 lapack::h44) lapack::h43h34)) (lisp::setf lapack::h44 (lisp::/ lapack::h33 (lisp::+ (f2cl-lib::sign lapack::disc lapack::ave) lapack::ave)))) (lisp::t (lisp::setf lapack::h44 (lisp::+ (f2cl-lib::sign lapack::disc lapack::ave) lapack::ave)))) (lisp::setf lapack::h33 lapack::h44) (lisp::setf lapack::h43h34 lapack::zero))))) (f2cl-lib::fdo (lapack::m (f2cl-lib::int-add lapack::i (f2cl-lib::int-sub 2)) (f2cl-lib::int-add lapack::m (f2cl-lib::int-sub 1))) ((lisp::> lapack::m lapack::l) lisp::nil) (lisp::tagbody (lisp::setf lapack::h11 (f2cl-lib::fref lapack::h-%data% (lapack::m lapack::m) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf lapack::h22 (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::m 1) (f2cl-lib::int-add lapack::m 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf lapack::h21 (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::m 1) lapack::m) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf lapack::h12 (f2cl-lib::fref lapack::h-%data% (lapack::m (f2cl-lib::int-add lapack::m 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf lapack::h44s (lisp::- lapack::h44 lapack::h11)) (lisp::setf lapack::h33s (lisp::- lapack::h33 lapack::h11)) (lisp::setf lapack::v1 (lisp::+ (lisp::/ (lisp::- (lisp::* lapack::h33s lapack::h44s) lapack::h43h34) lapack::h21) lapack::h12)) (lisp::setf lapack::v2 (lisp::- lapack::h22 lapack::h11 lapack::h33s lapack::h44s)) (lisp::setf lapack::v3 (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::m 2) (f2cl-lib::int-add lapack::m 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf lapack::s (lisp::+ (lisp::abs lapack::v1) (lisp::abs lapack::v2) (lisp::abs lapack::v3))) (lisp::setf lapack::v1 (lisp::/ lapack::v1 lapack::s)) (lisp::setf lapack::v2 (lisp::/ lapack::v2 lapack::s)) (lisp::setf lapack::v3 (lisp::/ lapack::v3 lapack::s)) (lisp::setf (f2cl-lib::fref lapack::v (1) ((1 3))) lapack::v1) (lisp::setf (f2cl-lib::fref lapack::v (2) ((1 3))) lapack::v2) (lisp::setf (f2cl-lib::fref lapack::v (3) ((1 3))) lapack::v3) (lisp::if (lisp::= lapack::m lapack::l) (lisp::go lapack::label50)) (lisp::setf lapack::h00 (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-sub lapack::m 1) (f2cl-lib::int-sub lapack::m 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf lapack::h10 (f2cl-lib::fref lapack::h-%data% (lapack::m (f2cl-lib::int-sub lapack::m 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf lapack::tst1 (lisp::* (lisp::abs lapack::v1) (lisp::+ (lisp::abs lapack::h00) (lisp::abs lapack::h11) (lisp::abs lapack::h22)))) (lisp::if (lisp::<= (lisp::* (lisp::abs lapack::h10) (lisp::+ (lisp::abs lapack::v2) (lisp::abs lapack::v3))) (lisp::* lapack::ulp lapack::tst1)) (lisp::go lapack::label50)) lapack::label40)) lapack::label50 (f2cl-lib::fdo (lapack::k lapack::m (f2cl-lib::int-add lapack::k 1)) ((lisp::> lapack::k (f2cl-lib::int-add lapack::i (f2cl-lib::int-sub 1))) lisp::nil) (lisp::tagbody (lisp::setf lapack::nr (lisp::min (lisp::the f2cl-lib::integer4 3) (lisp::the f2cl-lib::integer4 (f2cl-lib::int-add (f2cl-lib::int-sub lapack::i lapack::k) 1)))) (lisp::if (lisp::> lapack::k lapack::m) (blas::dcopy lapack::nr (f2cl-lib::array-slice lapack::h lisp::double-float (lapack::k (f2cl-lib::int-sub lapack::k 1)) ((1 lapack::ldh) (1 lisp::*))) 1 lapack::v 1)) (lisp::multiple-value-bind (lapack::var-0 lapack::var-1 lapack::var-2 lapack::var-3 lapack::var-4) (lapack::dlarfg lapack::nr (f2cl-lib::fref lapack::v (1) ((1 3))) (f2cl-lib::array-slice lapack::v lisp::double-float (2) ((1 3))) 1 lapack::t1) (lisp::declare (lisp::ignore lapack::var-0 lapack::var-2 lapack::var-3)) (lisp::setf (f2cl-lib::fref lapack::v (1) ((1 3))) lapack::var-1) (lisp::setf lapack::t1 lapack::var-4)) (lisp::cond ((lisp::> lapack::k lapack::m) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::k (f2cl-lib::int-sub lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (f2cl-lib::fref lapack::v (1) ((1 3)))) (lisp::setf (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::k 1) (f2cl-lib::int-sub lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) lapack::zero) (lisp::if (lisp::< lapack::k (f2cl-lib::int-sub lapack::i 1)) (lisp::setf (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::k 2) (f2cl-lib::int-sub lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) lapack::zero))) ((lisp::> lapack::m lapack::l) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::k (f2cl-lib::int-sub lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::- (f2cl-lib::fref lapack::h-%data% (lapack::k (f2cl-lib::int-sub lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%))))) (lisp::setf lapack::v2 (f2cl-lib::fref lapack::v (2) ((1 3)))) (lisp::setf lapack::t2 (lisp::* lapack::t1 lapack::v2)) (lisp::cond ((lisp::= lapack::nr 3) (lisp::setf lapack::v3 (f2cl-lib::fref lapack::v (3) ((1 3)))) (lisp::setf lapack::t3 (lisp::* lapack::t1 lapack::v3)) (f2cl-lib::fdo (lapack::j lapack::k (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j lapack::i2) lisp::nil) (lisp::tagbody (lisp::setf lapack::sum (lisp::+ (f2cl-lib::fref lapack::h-%data% (lapack::k lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::v2 (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::k 1) lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::* lapack::v3 (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::k 2) lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)))) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::k lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::- (f2cl-lib::fref lapack::h-%data% (lapack::k lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::sum lapack::t1))) (lisp::setf (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::k 1) lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::- (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::k 1) lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::sum lapack::t2))) (lisp::setf (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::k 2) lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::- (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::k 2) lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::sum lapack::t3))) lapack::label60)) (f2cl-lib::fdo (lapack::j lapack::i1 (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j (lisp::min (lisp::the f2cl-lib::integer4 (f2cl-lib::int-add lapack::k 3)) (lisp::the f2cl-lib::integer4 lapack::i))) lisp::nil) (lisp::tagbody (lisp::setf lapack::sum (lisp::+ (f2cl-lib::fref lapack::h-%data% (lapack::j lapack::k) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::v2 (f2cl-lib::fref lapack::h-%data% (lapack::j (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::* lapack::v3 (f2cl-lib::fref lapack::h-%data% (lapack::j (f2cl-lib::int-add lapack::k 2)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)))) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::j lapack::k) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::- (f2cl-lib::fref lapack::h-%data% (lapack::j lapack::k) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::sum lapack::t1))) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::j (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::- (f2cl-lib::fref lapack::h-%data% (lapack::j (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::sum lapack::t2))) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::j (f2cl-lib::int-add lapack::k 2)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::- (f2cl-lib::fref lapack::h-%data% (lapack::j (f2cl-lib::int-add lapack::k 2)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::sum lapack::t3))) lapack::label70)) (lisp::cond (lapack::wantz (f2cl-lib::fdo (lapack::j lapack::iloz (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j lapack::ihiz) lisp::nil) (lisp::tagbody (lisp::setf lapack::sum (lisp::+ (f2cl-lib::fref lapack::z-%data% (lapack::j lapack::k) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%) (lisp::* lapack::v2 (f2cl-lib::fref lapack::z-%data% (lapack::j (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%)) (lisp::* lapack::v3 (f2cl-lib::fref lapack::z-%data% (lapack::j (f2cl-lib::int-add lapack::k 2)) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%)))) (lisp::setf (f2cl-lib::fref lapack::z-%data% (lapack::j lapack::k) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%) (lisp::- (f2cl-lib::fref lapack::z-%data% (lapack::j lapack::k) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%) (lisp::* lapack::sum lapack::t1))) (lisp::setf (f2cl-lib::fref lapack::z-%data% (lapack::j (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%) (lisp::- (f2cl-lib::fref lapack::z-%data% (lapack::j (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%) (lisp::* lapack::sum lapack::t2))) (lisp::setf (f2cl-lib::fref lapack::z-%data% (lapack::j (f2cl-lib::int-add lapack::k 2)) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%) (lisp::- (f2cl-lib::fref lapack::z-%data% (lapack::j (f2cl-lib::int-add lapack::k 2)) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%) (lisp::* lapack::sum lapack::t3))) lapack::label80))))) ((lisp::= lapack::nr 2) (f2cl-lib::fdo (lapack::j lapack::k (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j lapack::i2) lisp::nil) (lisp::tagbody (lisp::setf lapack::sum (lisp::+ (f2cl-lib::fref lapack::h-%data% (lapack::k lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::v2 (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::k 1) lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)))) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::k lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::- (f2cl-lib::fref lapack::h-%data% (lapack::k lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::sum lapack::t1))) (lisp::setf (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::k 1) lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::- (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-add lapack::k 1) lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::sum lapack::t2))) lapack::label90)) (f2cl-lib::fdo (lapack::j lapack::i1 (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j lapack::i) lisp::nil) (lisp::tagbody (lisp::setf lapack::sum (lisp::+ (f2cl-lib::fref lapack::h-%data% (lapack::j lapack::k) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::v2 (f2cl-lib::fref lapack::h-%data% (lapack::j (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)))) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::j lapack::k) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::- (f2cl-lib::fref lapack::h-%data% (lapack::j lapack::k) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::sum lapack::t1))) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::j (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::- (f2cl-lib::fref lapack::h-%data% (lapack::j (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (lisp::* lapack::sum lapack::t2))) lapack::label100)) (lisp::cond (lapack::wantz (f2cl-lib::fdo (lapack::j lapack::iloz (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j lapack::ihiz) lisp::nil) (lisp::tagbody (lisp::setf lapack::sum (lisp::+ (f2cl-lib::fref lapack::z-%data% (lapack::j lapack::k) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%) (lisp::* lapack::v2 (f2cl-lib::fref lapack::z-%data% (lapack::j (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%)))) (lisp::setf (f2cl-lib::fref lapack::z-%data% (lapack::j lapack::k) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%) (lisp::- (f2cl-lib::fref lapack::z-%data% (lapack::j lapack::k) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%) (lisp::* lapack::sum lapack::t1))) (lisp::setf (f2cl-lib::fref lapack::z-%data% (lapack::j (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%) (lisp::- (f2cl-lib::fref lapack::z-%data% (lapack::j (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldz) (1 lisp::*)) lapack::z-%offset%) (lisp::* lapack::sum lapack::t2))) lapack::label110)))))) lapack::label120)) lapack::label130)) (lisp::setf lapack::info lapack::i) (lisp::go lapack::end_label) lapack::label140 (lisp::cond ((lisp::= lapack::l lapack::i) (lisp::setf (f2cl-lib::fref lapack::wr-%data% (lapack::i) ((1 lisp::*)) lapack::wr-%offset%) (f2cl-lib::fref lapack::h-%data% (lapack::i lapack::i) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf (f2cl-lib::fref lapack::wi-%data% (lapack::i) ((1 lisp::*)) lapack::wi-%offset%) lapack::zero)) ((lisp::= lapack::l (f2cl-lib::int-add lapack::i (f2cl-lib::int-sub 1))) (lisp::multiple-value-bind (lapack::var-0 lapack::var-1 lapack::var-2 lapack::var-3 lapack::var-4 lapack::var-5 lapack::var-6 lapack::var-7 lapack::var-8 lapack::var-9) (lapack::dlanv2 (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-sub lapack::i 1) (f2cl-lib::int-sub lapack::i 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-sub lapack::i 1) lapack::i) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (f2cl-lib::fref lapack::h-%data% (lapack::i (f2cl-lib::int-sub lapack::i 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (f2cl-lib::fref lapack::h-%data% (lapack::i lapack::i) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (f2cl-lib::fref lapack::wr-%data% ((f2cl-lib::int-sub lapack::i 1)) ((1 lisp::*)) lapack::wr-%offset%) (f2cl-lib::fref lapack::wi-%data% ((f2cl-lib::int-sub lapack::i 1)) ((1 lisp::*)) lapack::wi-%offset%) (f2cl-lib::fref lapack::wr-%data% (lapack::i) ((1 lisp::*)) lapack::wr-%offset%) (f2cl-lib::fref lapack::wi-%data% (lapack::i) ((1 lisp::*)) lapack::wi-%offset%) lapack::cs lapack::sn) (lisp::declare (lisp::ignore)) (lisp::setf (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-sub lapack::i 1) (f2cl-lib::int-sub lapack::i 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) lapack::var-0) (lisp::setf (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-sub lapack::i 1) lapack::i) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) lapack::var-1) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::i (f2cl-lib::int-sub lapack::i 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) lapack::var-2) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::i lapack::i) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) lapack::var-3) (lisp::setf (f2cl-lib::fref lapack::wr-%data% ((f2cl-lib::int-sub lapack::i 1)) ((1 lisp::*)) lapack::wr-%offset%) lapack::var-4) (lisp::setf (f2cl-lib::fref lapack::wi-%data% ((f2cl-lib::int-sub lapack::i 1)) ((1 lisp::*)) lapack::wi-%offset%) lapack::var-5) (lisp::setf (f2cl-lib::fref lapack::wr-%data% (lapack::i) ((1 lisp::*)) lapack::wr-%offset%) lapack::var-6) (lisp::setf (f2cl-lib::fref lapack::wi-%data% (lapack::i) ((1 lisp::*)) lapack::wi-%offset%) lapack::var-7) (lisp::setf lapack::cs lapack::var-8) (lisp::setf lapack::sn lapack::var-9)) (lisp::cond (lapack::wantt (lisp::if (lisp::> lapack::i2 lapack::i) (blas::drot (f2cl-lib::int-sub lapack::i2 lapack::i) (f2cl-lib::array-slice lapack::h lisp::double-float ((lisp::+ lapack::i (f2cl-lib::int-sub 1)) (f2cl-lib::int-add lapack::i 1)) ((1 lapack::ldh) (1 lisp::*))) lapack::ldh (f2cl-lib::array-slice lapack::h lisp::double-float (lapack::i (f2cl-lib::int-add lapack::i 1)) ((1 lapack::ldh) (1 lisp::*))) lapack::ldh lapack::cs lapack::sn)) (blas::drot (f2cl-lib::int-sub lapack::i lapack::i1 1) (f2cl-lib::array-slice lapack::h lisp::double-float (lapack::i1 (f2cl-lib::int-sub lapack::i 1)) ((1 lapack::ldh) (1 lisp::*))) 1 (f2cl-lib::array-slice lapack::h lisp::double-float (lapack::i1 lapack::i) ((1 lapack::ldh) (1 lisp::*))) 1 lapack::cs lapack::sn))) (lisp::cond (lapack::wantz (blas::drot lapack::nz (f2cl-lib::array-slice lapack::z lisp::double-float (lapack::iloz (f2cl-lib::int-sub lapack::i 1)) ((1 lapack::ldz) (1 lisp::*))) 1 (f2cl-lib::array-slice lapack::z lisp::double-float (lapack::iloz lapack::i) ((1 lapack::ldz) (1 lisp::*))) 1 lapack::cs lapack::sn))))) (lisp::setf lapack::itn (f2cl-lib::int-sub lapack::itn lapack::its)) (lisp::setf lapack::i (f2cl-lib::int-sub lapack::l 1)) (lisp::go lapack::label10) lapack::label150 (lisp::go lapack::end_label) lapack::end_label (lisp::return (lisp::values lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lapack::info)))))))))
)
