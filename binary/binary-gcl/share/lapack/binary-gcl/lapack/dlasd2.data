       
#(#! 
(lisp::in-package :lapack)#! 
(lisp::in-package "CL-USER")
#((system::%init . #((lisp::let* ((lapack::zero 0.0F0) (lapack::one 1.0F0) (lapack::two 2.0F0) (lapack::eight 8.0F0)) (lisp::declare (lisp::type (lisp::double-float 0.0F0 0.0F0) lapack::zero) (lisp::type (lisp::double-float 1.0F0 1.0F0) lapack::one) (lisp::type (lisp::double-float 2.0F0 2.0F0) lapack::two) (lisp::type (lisp::double-float 8.0F0 8.0F0) lapack::eight) (lisp::ignorable lapack::zero lapack::one lapack::two lapack::eight)) (lisp::defun lapack::dlasd2 (lapack::nl lapack::nr lapack::sqre lapack::k lapack::d lapack::z lapack::alpha lapack::beta lapack::u lapack::ldu lapack::vt lapack::ldvt lapack::dsigma lapack::u2 lapack::ldu2 lapack::vt2 lapack::ldvt2 lapack::idxp lapack::idx lapack::idxc lapack::idxq lapack::coltyp lapack::info) (lisp::declare (lisp::type (lisp::array f2cl-lib::integer4 (lisp::*)) lapack::coltyp lapack::idxq lapack::idxc lapack::idx lapack::idxp) (lisp::type (lisp::double-float) lapack::beta lapack::alpha) (lisp::type (lisp::array lisp::double-float (lisp::*)) lapack::vt2 lapack::u2 lapack::dsigma lapack::vt lapack::u lapack::z lapack::d) (lisp::type (f2cl-lib::integer4) lapack::info lapack::ldvt2 lapack::ldu2 lapack::ldvt lapack::ldu lapack::k lapack::sqre lapack::nr lapack::nl)) (f2cl-lib::with-multi-array-data ((lapack::d lisp::double-float lapack::d-%data% lapack::d-%offset%) (lapack::z lisp::double-float lapack::z-%data% lapack::z-%offset%) (lapack::u lisp::double-float lapack::u-%data% lapack::u-%offset%) (lapack::vt lisp::double-float lapack::vt-%data% lapack::vt-%offset%) (lapack::dsigma lisp::double-float lapack::dsigma-%data% lapack::dsigma-%offset%) (lapack::u2 lisp::double-float lapack::u2-%data% lapack::u2-%offset%) (lapack::vt2 lisp::double-float lapack::vt2-%data% lapack::vt2-%offset%) (lapack::idxp f2cl-lib::integer4 lapack::idxp-%data% lapack::idxp-%offset%) (lapack::idx f2cl-lib::integer4 lapack::idx-%data% lapack::idx-%offset%) (lapack::idxc f2cl-lib::integer4 lapack::idxc-%data% lapack::idxc-%offset%) (lapack::idxq f2cl-lib::integer4 lapack::idxq-%data% lapack::idxq-%offset%) (lapack::coltyp f2cl-lib::integer4 lapack::coltyp-%data% lapack::coltyp-%offset%)) (lisp::prog ((lapack::c 0.0F0) (lapack::eps 0.0F0) (lapack::hlftol 0.0F0) (lapack::s 0.0F0) (lapack::tau 0.0F0) (lapack::tol 0.0F0) (lapack::z1 0.0F0) (lapack::ct 0) (lapack::i 0) (lapack::idxi 0) (lapack::idxj 0) (lapack::idxjp 0) (lapack::j 0) (lapack::jp 0) (lapack::jprev 0) (lapack::k2 0) (lapack::m 0) (lapack::n 0) (lapack::nlp1 0) (lapack::nlp2 0) (lapack::ctot (lisp::make-array 4 :element-type (lisp::quote f2cl-lib::integer4))) (lapack::psm (lisp::make-array 4 :element-type (lisp::quote f2cl-lib::integer4)))) (lisp::declare (lisp::type (lisp::double-float) lapack::c lapack::eps lapack::hlftol lapack::s lapack::tau lapack::tol lapack::z1) (lisp::type (f2cl-lib::integer4) lapack::ct lapack::i lapack::idxi lapack::idxj lapack::idxjp lapack::j lapack::jp lapack::jprev lapack::k2 lapack::m lapack::n lapack::nlp1 lapack::nlp2) (lisp::type (lisp::array f2cl-lib::integer4 (4)) lapack::ctot lapack::psm)) (lisp::setf lapack::info 0) (lisp::cond ((lisp::< lapack::nl 1) (lisp::setf lapack::info -1)) ((lisp::< lapack::nr 1) (lisp::setf lapack::info -2)) ((lisp::and (lisp::/= lapack::sqre 1) (lisp::/= lapack::sqre 0)) (lisp::setf lapack::info -3))) (lisp::setf lapack::n (f2cl-lib::int-add lapack::nl lapack::nr 1)) (lisp::setf lapack::m (f2cl-lib::int-add lapack::n lapack::sqre)) (lisp::cond ((lisp::< lapack::ldu lapack::n) (lisp::setf lapack::info -10)) ((lisp::< lapack::ldvt lapack::m) (lisp::setf lapack::info -12)) ((lisp::< lapack::ldu2 lapack::n) (lisp::setf lapack::info -15)) ((lisp::< lapack::ldvt2 lapack::m) (lisp::setf lapack::info -17))) (lisp::cond ((lisp::/= lapack::info 0) (blas::xerbla "DLASD2" (f2cl-lib::int-sub lapack::info)) (lisp::go lapack::end_label))) (lisp::setf lapack::nlp1 (f2cl-lib::int-add lapack::nl 1)) (lisp::setf lapack::nlp2 (f2cl-lib::int-add lapack::nl 2)) (lisp::setf lapack::z1 (lisp::* lapack::alpha (f2cl-lib::fref lapack::vt-%data% (lapack::nlp1 lapack::nlp1) ((1 lapack::ldvt) (1 lisp::*)) lapack::vt-%offset%))) (lisp::setf (f2cl-lib::fref lapack::z-%data% (1) ((1 lisp::*)) lapack::z-%offset%) lapack::z1) (f2cl-lib::fdo (lapack::i lapack::nl (f2cl-lib::int-add lapack::i (f2cl-lib::int-sub 1))) ((lisp::> lapack::i 1) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::z-%data% ((f2cl-lib::int-add lapack::i 1)) ((1 lisp::*)) lapack::z-%offset%) (lisp::* lapack::alpha (f2cl-lib::fref lapack::vt-%data% (lapack::i lapack::nlp1) ((1 lapack::ldvt) (1 lisp::*)) lapack::vt-%offset%))) (lisp::setf (f2cl-lib::fref lapack::d-%data% ((f2cl-lib::int-add lapack::i 1)) ((1 lisp::*)) lapack::d-%offset%) (f2cl-lib::fref lapack::d-%data% (lapack::i) ((1 lisp::*)) lapack::d-%offset%)) (lisp::setf (f2cl-lib::fref lapack::idxq-%data% ((f2cl-lib::int-add lapack::i 1)) ((1 lisp::*)) lapack::idxq-%offset%) (f2cl-lib::int-add (f2cl-lib::fref lapack::idxq-%data% (lapack::i) ((1 lisp::*)) lapack::idxq-%offset%) 1)) lapack::label10)) (f2cl-lib::fdo (lapack::i lapack::nlp2 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::m) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::z-%data% (lapack::i) ((1 lisp::*)) lapack::z-%offset%) (lisp::* lapack::beta (f2cl-lib::fref lapack::vt-%data% (lapack::i lapack::nlp2) ((1 lapack::ldvt) (1 lisp::*)) lapack::vt-%offset%))) lapack::label20)) (f2cl-lib::fdo (lapack::i 2 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::nlp1) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::coltyp-%data% (lapack::i) ((1 lisp::*)) lapack::coltyp-%offset%) 1) lapack::label30)) (f2cl-lib::fdo (lapack::i lapack::nlp2 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::n) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::coltyp-%data% (lapack::i) ((1 lisp::*)) lapack::coltyp-%offset%) 2) lapack::label40)) (f2cl-lib::fdo (lapack::i lapack::nlp2 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::n) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::idxq-%data% (lapack::i) ((1 lisp::*)) lapack::idxq-%offset%) (f2cl-lib::int-add (f2cl-lib::fref lapack::idxq-%data% (lapack::i) ((1 lisp::*)) lapack::idxq-%offset%) lapack::nlp1)) lapack::label50)) (f2cl-lib::fdo (lapack::i 2 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::n) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::dsigma-%data% (lapack::i) ((1 lisp::*)) lapack::dsigma-%offset%) (f2cl-lib::fref lapack::d-%data% ((f2cl-lib::fref lapack::idxq (lapack::i) ((1 lisp::*)))) ((1 lisp::*)) lapack::d-%offset%)) (lisp::setf (f2cl-lib::fref lapack::u2-%data% (lapack::i 1) ((1 lapack::ldu2) (1 lisp::*)) lapack::u2-%offset%) (f2cl-lib::fref lapack::z-%data% ((f2cl-lib::fref lapack::idxq (lapack::i) ((1 lisp::*)))) ((1 lisp::*)) lapack::z-%offset%)) (lisp::setf (f2cl-lib::fref lapack::idxc-%data% (lapack::i) ((1 lisp::*)) lapack::idxc-%offset%) (f2cl-lib::fref lapack::coltyp-%data% ((f2cl-lib::fref lapack::idxq (lapack::i) ((1 lisp::*)))) ((1 lisp::*)) lapack::coltyp-%offset%)) lapack::label60)) (lapack::dlamrg lapack::nl lapack::nr (f2cl-lib::array-slice lapack::dsigma lisp::double-float (2) ((1 lisp::*))) 1 1 (f2cl-lib::array-slice lapack::idx f2cl-lib::integer4 (2) ((1 lisp::*)))) (f2cl-lib::fdo (lapack::i 2 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::n) lisp::nil) (lisp::tagbody (lisp::setf lapack::idxi (f2cl-lib::int-add 1 (f2cl-lib::fref lapack::idx-%data% (lapack::i) ((1 lisp::*)) lapack::idx-%offset%))) (lisp::setf (f2cl-lib::fref lapack::d-%data% (lapack::i) ((1 lisp::*)) lapack::d-%offset%) (f2cl-lib::fref lapack::dsigma-%data% (lapack::idxi) ((1 lisp::*)) lapack::dsigma-%offset%)) (lisp::setf (f2cl-lib::fref lapack::z-%data% (lapack::i) ((1 lisp::*)) lapack::z-%offset%) (f2cl-lib::fref lapack::u2-%data% (lapack::idxi 1) ((1 lapack::ldu2) (1 lisp::*)) lapack::u2-%offset%)) (lisp::setf (f2cl-lib::fref lapack::coltyp-%data% (lapack::i) ((1 lisp::*)) lapack::coltyp-%offset%) (f2cl-lib::fref lapack::idxc-%data% (lapack::idxi) ((1 lisp::*)) lapack::idxc-%offset%)) lapack::label70)) (lisp::setf lapack::eps (lapack::dlamch "Epsilon")) (lisp::setf lapack::tol (lisp::max (lisp::abs lapack::alpha) (lisp::abs lapack::beta))) (lisp::setf lapack::tol (lisp::* lapack::eight lapack::eps (lisp::max (lisp::abs (f2cl-lib::fref lapack::d-%data% (lapack::n) ((1 lisp::*)) lapack::d-%offset%)) lapack::tol))) (lisp::setf lapack::k 1) (lisp::setf lapack::k2 (f2cl-lib::int-add lapack::n 1)) (f2cl-lib::fdo (lapack::j 2 (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j lapack::n) lisp::nil) (lisp::tagbody (lisp::cond ((lisp::<= (lisp::abs (f2cl-lib::fref lapack::z (lapack::j) ((1 lisp::*)))) lapack::tol) (lisp::setf lapack::k2 (f2cl-lib::int-sub lapack::k2 1)) (lisp::setf (f2cl-lib::fref lapack::idxp-%data% (lapack::k2) ((1 lisp::*)) lapack::idxp-%offset%) lapack::j) (lisp::setf (f2cl-lib::fref lapack::coltyp-%data% (lapack::j) ((1 lisp::*)) lapack::coltyp-%offset%) 4) (lisp::if (lisp::= lapack::j lapack::n) (lisp::go lapack::label120))) (lisp::t (lisp::setf lapack::jprev lapack::j) (lisp::go lapack::label90))) lapack::label80)) lapack::label90 (lisp::setf lapack::j lapack::jprev) lapack::label100 (lisp::setf lapack::j (f2cl-lib::int-add lapack::j 1)) (lisp::if (lisp::> lapack::j lapack::n) (lisp::go lapack::label110)) (lisp::cond ((lisp::<= (lisp::abs (f2cl-lib::fref lapack::z (lapack::j) ((1 lisp::*)))) lapack::tol) (lisp::setf lapack::k2 (f2cl-lib::int-sub lapack::k2 1)) (lisp::setf (f2cl-lib::fref lapack::idxp-%data% (lapack::k2) ((1 lisp::*)) lapack::idxp-%offset%) lapack::j) (lisp::setf (f2cl-lib::fref lapack::coltyp-%data% (lapack::j) ((1 lisp::*)) lapack::coltyp-%offset%) 4)) (lisp::t (lisp::cond ((lisp::<= (lisp::abs (lisp::+ (f2cl-lib::fref lapack::d (lapack::j) ((1 lisp::*))) (lisp::- (f2cl-lib::fref lapack::d (lapack::jprev) ((1 lisp::*)))))) lapack::tol) (lisp::setf lapack::s (f2cl-lib::fref lapack::z-%data% (lapack::jprev) ((1 lisp::*)) lapack::z-%offset%)) (lisp::setf lapack::c (f2cl-lib::fref lapack::z-%data% (lapack::j) ((1 lisp::*)) lapack::z-%offset%)) (lisp::setf lapack::tau (lapack::dlapy2 lapack::c lapack::s)) (lisp::setf lapack::c (lisp::/ lapack::c lapack::tau)) (lisp::setf lapack::s (lisp::/ (lisp::- lapack::s) lapack::tau)) (lisp::setf (f2cl-lib::fref lapack::z-%data% (lapack::j) ((1 lisp::*)) lapack::z-%offset%) lapack::tau) (lisp::setf (f2cl-lib::fref lapack::z-%data% (lapack::jprev) ((1 lisp::*)) lapack::z-%offset%) lapack::zero) (lisp::setf lapack::idxjp (f2cl-lib::fref lapack::idxq-%data% ((f2cl-lib::int-add (f2cl-lib::fref lapack::idx (lapack::jprev) ((1 lisp::*))) 1)) ((1 lisp::*)) lapack::idxq-%offset%)) (lisp::setf lapack::idxj (f2cl-lib::fref lapack::idxq-%data% ((f2cl-lib::int-add (f2cl-lib::fref lapack::idx (lapack::j) ((1 lisp::*))) 1)) ((1 lisp::*)) lapack::idxq-%offset%)) (lisp::cond ((lisp::<= lapack::idxjp lapack::nlp1) (lisp::setf lapack::idxjp (f2cl-lib::int-sub lapack::idxjp 1)))) (lisp::cond ((lisp::<= lapack::idxj lapack::nlp1) (lisp::setf lapack::idxj (f2cl-lib::int-sub lapack::idxj 1)))) (blas::drot lapack::n (f2cl-lib::array-slice lapack::u lisp::double-float (1 lapack::idxjp) ((1 lapack::ldu) (1 lisp::*))) 1 (f2cl-lib::array-slice lapack::u lisp::double-float (1 lapack::idxj) ((1 lapack::ldu) (1 lisp::*))) 1 lapack::c lapack::s) (blas::drot lapack::m (f2cl-lib::array-slice lapack::vt lisp::double-float (lapack::idxjp 1) ((1 lapack::ldvt) (1 lisp::*))) lapack::ldvt (f2cl-lib::array-slice lapack::vt lisp::double-float (lapack::idxj 1) ((1 lapack::ldvt) (1 lisp::*))) lapack::ldvt lapack::c lapack::s) (lisp::cond ((lisp::/= (f2cl-lib::fref lapack::coltyp (lapack::j) ((1 lisp::*))) (f2cl-lib::fref lapack::coltyp (lapack::jprev) ((1 lisp::*)))) (lisp::setf (f2cl-lib::fref lapack::coltyp-%data% (lapack::j) ((1 lisp::*)) lapack::coltyp-%offset%) 3))) (lisp::setf (f2cl-lib::fref lapack::coltyp-%data% (lapack::jprev) ((1 lisp::*)) lapack::coltyp-%offset%) 4) (lisp::setf lapack::k2 (f2cl-lib::int-sub lapack::k2 1)) (lisp::setf (f2cl-lib::fref lapack::idxp-%data% (lapack::k2) ((1 lisp::*)) lapack::idxp-%offset%) lapack::jprev) (lisp::setf lapack::jprev lapack::j)) (lisp::t (lisp::setf lapack::k (f2cl-lib::int-add lapack::k 1)) (lisp::setf (f2cl-lib::fref lapack::u2-%data% (lapack::k 1) ((1 lapack::ldu2) (1 lisp::*)) lapack::u2-%offset%) (f2cl-lib::fref lapack::z-%data% (lapack::jprev) ((1 lisp::*)) lapack::z-%offset%)) (lisp::setf (f2cl-lib::fref lapack::dsigma-%data% (lapack::k) ((1 lisp::*)) lapack::dsigma-%offset%) (f2cl-lib::fref lapack::d-%data% (lapack::jprev) ((1 lisp::*)) lapack::d-%offset%)) (lisp::setf (f2cl-lib::fref lapack::idxp-%data% (lapack::k) ((1 lisp::*)) lapack::idxp-%offset%) lapack::jprev) (lisp::setf lapack::jprev lapack::j))))) (lisp::go lapack::label100) lapack::label110 (lisp::setf lapack::k (f2cl-lib::int-add lapack::k 1)) (lisp::setf (f2cl-lib::fref lapack::u2-%data% (lapack::k 1) ((1 lapack::ldu2) (1 lisp::*)) lapack::u2-%offset%) (f2cl-lib::fref lapack::z-%data% (lapack::jprev) ((1 lisp::*)) lapack::z-%offset%)) (lisp::setf (f2cl-lib::fref lapack::dsigma-%data% (lapack::k) ((1 lisp::*)) lapack::dsigma-%offset%) (f2cl-lib::fref lapack::d-%data% (lapack::jprev) ((1 lisp::*)) lapack::d-%offset%)) (lisp::setf (f2cl-lib::fref lapack::idxp-%data% (lapack::k) ((1 lisp::*)) lapack::idxp-%offset%) lapack::jprev) lapack::label120 (f2cl-lib::fdo (lapack::j 1 (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j 4) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::ctot (lapack::j) ((1 4))) 0) lapack::label130)) (f2cl-lib::fdo (lapack::j 2 (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j lapack::n) lisp::nil) (lisp::tagbody (lisp::setf lapack::ct (f2cl-lib::fref lapack::coltyp-%data% (lapack::j) ((1 lisp::*)) lapack::coltyp-%offset%)) (lisp::setf (f2cl-lib::fref lapack::ctot (lapack::ct) ((1 4))) (f2cl-lib::int-add (f2cl-lib::fref lapack::ctot (lapack::ct) ((1 4))) 1)) lapack::label140)) (lisp::setf (f2cl-lib::fref lapack::psm (1) ((1 4))) 2) (lisp::setf (f2cl-lib::fref lapack::psm (2) ((1 4))) (f2cl-lib::int-add 2 (f2cl-lib::fref lapack::ctot (1) ((1 4))))) (lisp::setf (f2cl-lib::fref lapack::psm (3) ((1 4))) (f2cl-lib::int-add (f2cl-lib::fref lapack::psm (2) ((1 4))) (f2cl-lib::fref lapack::ctot (2) ((1 4))))) (lisp::setf (f2cl-lib::fref lapack::psm (4) ((1 4))) (f2cl-lib::int-add (f2cl-lib::fref lapack::psm (3) ((1 4))) (f2cl-lib::fref lapack::ctot (3) ((1 4))))) (f2cl-lib::fdo (lapack::j 2 (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j lapack::n) lisp::nil) (lisp::tagbody (lisp::setf lapack::jp (f2cl-lib::fref lapack::idxp-%data% (lapack::j) ((1 lisp::*)) lapack::idxp-%offset%)) (lisp::setf lapack::ct (f2cl-lib::fref lapack::coltyp-%data% (lapack::jp) ((1 lisp::*)) lapack::coltyp-%offset%)) (lisp::setf (f2cl-lib::fref lapack::idxc-%data% ((f2cl-lib::fref lapack::psm (lapack::ct) ((1 4)))) ((1 lisp::*)) lapack::idxc-%offset%) lapack::j) (lisp::setf (f2cl-lib::fref lapack::psm (lapack::ct) ((1 4))) (f2cl-lib::int-add (f2cl-lib::fref lapack::psm (lapack::ct) ((1 4))) 1)) lapack::label150)) (f2cl-lib::fdo (lapack::j 2 (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j lapack::n) lisp::nil) (lisp::tagbody (lisp::setf lapack::jp (f2cl-lib::fref lapack::idxp-%data% (lapack::j) ((1 lisp::*)) lapack::idxp-%offset%)) (lisp::setf (f2cl-lib::fref lapack::dsigma-%data% (lapack::j) ((1 lisp::*)) lapack::dsigma-%offset%) (f2cl-lib::fref lapack::d-%data% (lapack::jp) ((1 lisp::*)) lapack::d-%offset%)) (lisp::setf lapack::idxj (f2cl-lib::fref lapack::idxq-%data% ((f2cl-lib::int-add (f2cl-lib::fref lapack::idx ((f2cl-lib::fref lapack::idxp ((f2cl-lib::fref lapack::idxc (lapack::j) ((1 lisp::*)))) ((1 lisp::*)))) ((1 lisp::*))) 1)) ((1 lisp::*)) lapack::idxq-%offset%)) (lisp::cond ((lisp::<= lapack::idxj lapack::nlp1) (lisp::setf lapack::idxj (f2cl-lib::int-sub lapack::idxj 1)))) (blas::dcopy lapack::n (f2cl-lib::array-slice lapack::u lisp::double-float (1 lapack::idxj) ((1 lapack::ldu) (1 lisp::*))) 1 (f2cl-lib::array-slice lapack::u2 lisp::double-float (1 lapack::j) ((1 lapack::ldu2) (1 lisp::*))) 1) (blas::dcopy lapack::m (f2cl-lib::array-slice lapack::vt lisp::double-float (lapack::idxj 1) ((1 lapack::ldvt) (1 lisp::*))) lapack::ldvt (f2cl-lib::array-slice lapack::vt2 lisp::double-float (lapack::j 1) ((1 lapack::ldvt2) (1 lisp::*))) lapack::ldvt2) lapack::label160)) (lisp::setf (f2cl-lib::fref lapack::dsigma-%data% (1) ((1 lisp::*)) lapack::dsigma-%offset%) lapack::zero) (lisp::setf lapack::hlftol (lisp::/ lapack::tol lapack::two)) (lisp::if (lisp::<= (lisp::abs (f2cl-lib::fref lapack::dsigma-%data% (2) ((1 lisp::*)) lapack::dsigma-%offset%)) lapack::hlftol) (lisp::setf (f2cl-lib::fref lapack::dsigma-%data% (2) ((1 lisp::*)) lapack::dsigma-%offset%) lapack::hlftol)) (lisp::cond ((lisp::> lapack::m lapack::n) (lisp::setf (f2cl-lib::fref lapack::z-%data% (1) ((1 lisp::*)) lapack::z-%offset%) (lapack::dlapy2 lapack::z1 (f2cl-lib::fref lapack::z-%data% (lapack::m) ((1 lisp::*)) lapack::z-%offset%))) (lisp::cond ((lisp::<= (f2cl-lib::fref lapack::z (1) ((1 lisp::*))) lapack::tol) (lisp::setf lapack::c lapack::one) (lisp::setf lapack::s lapack::zero) (lisp::setf (f2cl-lib::fref lapack::z-%data% (1) ((1 lisp::*)) lapack::z-%offset%) lapack::tol)) (lisp::t (lisp::setf lapack::c (lisp::/ lapack::z1 (f2cl-lib::fref lapack::z-%data% (1) ((1 lisp::*)) lapack::z-%offset%))) (lisp::setf lapack::s (lisp::/ (f2cl-lib::fref lapack::z-%data% (lapack::m) ((1 lisp::*)) lapack::z-%offset%) (f2cl-lib::fref lapack::z-%data% (1) ((1 lisp::*)) lapack::z-%offset%)))))) (lisp::t (lisp::cond ((lisp::<= (lisp::abs lapack::z1) lapack::tol) (lisp::setf (f2cl-lib::fref lapack::z-%data% (1) ((1 lisp::*)) lapack::z-%offset%) lapack::tol)) (lisp::t (lisp::setf (f2cl-lib::fref lapack::z-%data% (1) ((1 lisp::*)) lapack::z-%offset%) lapack::z1))))) (blas::dcopy (f2cl-lib::int-sub lapack::k 1) (f2cl-lib::array-slice lapack::u2 lisp::double-float (2 1) ((1 lapack::ldu2) (1 lisp::*))) 1 (f2cl-lib::array-slice lapack::z lisp::double-float (2) ((1 lisp::*))) 1) (lapack::dlaset "A" lapack::n 1 lapack::zero lapack::zero lapack::u2 lapack::ldu2) (lisp::setf (f2cl-lib::fref lapack::u2-%data% (lapack::nlp1 1) ((1 lapack::ldu2) (1 lisp::*)) lapack::u2-%offset%) lapack::one) (lisp::cond ((lisp::> lapack::m lapack::n) (f2cl-lib::fdo (lapack::i 1 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::nlp1) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::vt-%data% (lapack::m lapack::i) ((1 lapack::ldvt) (1 lisp::*)) lapack::vt-%offset%) (lisp::* (lisp::- lapack::s) (f2cl-lib::fref lapack::vt-%data% (lapack::nlp1 lapack::i) ((1 lapack::ldvt) (1 lisp::*)) lapack::vt-%offset%))) (lisp::setf (f2cl-lib::fref lapack::vt2-%data% (1 lapack::i) ((1 lapack::ldvt2) (1 lisp::*)) lapack::vt2-%offset%) (lisp::* lapack::c (f2cl-lib::fref lapack::vt-%data% (lapack::nlp1 lapack::i) ((1 lapack::ldvt) (1 lisp::*)) lapack::vt-%offset%))) lapack::label170)) (f2cl-lib::fdo (lapack::i lapack::nlp2 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::m) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::vt2-%data% (1 lapack::i) ((1 lapack::ldvt2) (1 lisp::*)) lapack::vt2-%offset%) (lisp::* lapack::s (f2cl-lib::fref lapack::vt-%data% (lapack::m lapack::i) ((1 lapack::ldvt) (1 lisp::*)) lapack::vt-%offset%))) (lisp::setf (f2cl-lib::fref lapack::vt-%data% (lapack::m lapack::i) ((1 lapack::ldvt) (1 lisp::*)) lapack::vt-%offset%) (lisp::* lapack::c (f2cl-lib::fref lapack::vt-%data% (lapack::m lapack::i) ((1 lapack::ldvt) (1 lisp::*)) lapack::vt-%offset%))) lapack::label180))) (lisp::t (blas::dcopy lapack::m (f2cl-lib::array-slice lapack::vt lisp::double-float (lapack::nlp1 1) ((1 lapack::ldvt) (1 lisp::*))) lapack::ldvt (f2cl-lib::array-slice lapack::vt2 lisp::double-float (1 1) ((1 lapack::ldvt2) (1 lisp::*))) lapack::ldvt2))) (lisp::cond ((lisp::> lapack::m lapack::n) (blas::dcopy lapack::m (f2cl-lib::array-slice lapack::vt lisp::double-float (lapack::m 1) ((1 lapack::ldvt) (1 lisp::*))) lapack::ldvt (f2cl-lib::array-slice lapack::vt2 lisp::double-float (lapack::m 1) ((1 lapack::ldvt2) (1 lisp::*))) lapack::ldvt2))) (lisp::cond ((lisp::> lapack::n lapack::k) (blas::dcopy (f2cl-lib::int-sub lapack::n lapack::k) (f2cl-lib::array-slice lapack::dsigma lisp::double-float ((lisp::+ lapack::k 1)) ((1 lisp::*))) 1 (f2cl-lib::array-slice lapack::d lisp::double-float ((lisp::+ lapack::k 1)) ((1 lisp::*))) 1) (lapack::dlacpy "A" lapack::n (f2cl-lib::int-sub lapack::n lapack::k) (f2cl-lib::array-slice lapack::u2 lisp::double-float (1 (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldu2) (1 lisp::*))) lapack::ldu2 (f2cl-lib::array-slice lapack::u lisp::double-float (1 (f2cl-lib::int-add lapack::k 1)) ((1 lapack::ldu) (1 lisp::*))) lapack::ldu) (lapack::dlacpy "A" (f2cl-lib::int-sub lapack::n lapack::k) lapack::m (f2cl-lib::array-slice lapack::vt2 lisp::double-float ((lisp::+ lapack::k 1) 1) ((1 lapack::ldvt2) (1 lisp::*))) lapack::ldvt2 (f2cl-lib::array-slice lapack::vt lisp::double-float ((lisp::+ lapack::k 1) 1) ((1 lapack::ldvt) (1 lisp::*))) lapack::ldvt))) (f2cl-lib::fdo (lapack::j 1 (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j 4) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::coltyp-%data% (lapack::j) ((1 lisp::*)) lapack::coltyp-%offset%) (f2cl-lib::fref lapack::ctot (lapack::j) ((1 4)))) lapack::label190)) (lisp::go lapack::end_label) lapack::end_label (lisp::return (lisp::values lisp::nil lisp::nil lisp::nil lapack::k lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lapack::info)))))))))
)
