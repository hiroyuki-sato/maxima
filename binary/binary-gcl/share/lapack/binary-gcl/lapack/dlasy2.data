       
#(#! 
(lisp::in-package :lapack)#! 
(lisp::in-package "CL-USER")
#((system::%init . #((lisp::let* ((lapack::zero 0.0F0) (lapack::one 1.0F0) (lapack::two 2.0F0) (lapack::half 0.5F0) (lapack::eight 8.0F0)) (lisp::declare (lisp::type (lisp::double-float 0.0F0 0.0F0) lapack::zero) (lisp::type (lisp::double-float 1.0F0 1.0F0) lapack::one) (lisp::type (lisp::double-float 2.0F0 2.0F0) lapack::two) (lisp::type (lisp::double-float 0.5F0 0.5F0) lapack::half) (lisp::type (lisp::double-float 8.0F0 8.0F0) lapack::eight) (lisp::ignorable lapack::zero lapack::one lapack::two lapack::half lapack::eight)) (lisp::let ((lapack::bswpiv (lisp::make-array 4 :element-type (lisp::quote lisp::t) :initial-contents (lisp::quote (lisp::nil lisp::t lisp::nil lisp::t)))) (lapack::xswpiv (lisp::make-array 4 :element-type (lisp::quote lisp::t) :initial-contents (lisp::quote (lisp::nil lisp::nil lisp::t lisp::t)))) (lapack::locu22 (lisp::make-array 4 :element-type (lisp::quote f2cl-lib::integer4) :initial-contents (lisp::quote (4 3 2 1)))) (lapack::locl21 (lisp::make-array 4 :element-type (lisp::quote f2cl-lib::integer4) :initial-contents (lisp::quote (2 1 4 3)))) (lapack::locu12 (lisp::make-array 4 :element-type (lisp::quote f2cl-lib::integer4) :initial-contents (lisp::quote (3 4 1 2))))) (lisp::declare (lisp::type (lisp::array f2cl-lib::logical (4)) lapack::bswpiv lapack::xswpiv) (lisp::type (lisp::array f2cl-lib::integer4 (4)) lapack::locu22 lapack::locl21 lapack::locu12)) (lisp::defun lapack::dlasy2 (lapack::ltranl lapack::ltranr lapack::isgn lapack::n1 lapack::n2 lapack::tl lapack::ldtl lapack::tr lapack::ldtr lapack::b lapack::ldb$ lapack::scale lapack::x lapack::ldx lapack::xnorm lapack::info) (lisp::declare (lisp::type (lisp::double-float) lapack::xnorm lapack::scale) (lisp::type (lisp::array lisp::double-float (lisp::*)) lapack::x lapack::b lapack::tr lapack::tl) (lisp::type (f2cl-lib::integer4) lapack::info lapack::ldx lapack::ldb$ lapack::ldtr lapack::ldtl lapack::n2 lapack::n1 lapack::isgn) (lisp::type f2cl-lib::logical lapack::ltranr lapack::ltranl)) (f2cl-lib::with-multi-array-data ((lapack::tl lisp::double-float lapack::tl-%data% lapack::tl-%offset%) (lapack::tr lisp::double-float lapack::tr-%data% lapack::tr-%offset%) (lapack::b lisp::double-float lapack::b-%data% lapack::b-%offset%) (lapack::x lisp::double-float lapack::x-%data% lapack::x-%offset%)) (lisp::prog ((lapack::btmp (lisp::make-array 4 :element-type (lisp::quote lisp::double-float))) (lapack::t16 (lisp::make-array 16 :element-type (lisp::quote lisp::double-float))) (lapack::tmp (lisp::make-array 4 :element-type (lisp::quote lisp::double-float))) (lapack::x2 (lisp::make-array 2 :element-type (lisp::quote lisp::double-float))) (lapack::jpiv (lisp::make-array 4 :element-type (lisp::quote f2cl-lib::integer4))) (lapack::bet 0.0F0) (lapack::eps 0.0F0) (lapack::gam 0.0F0) (lapack::l21 0.0F0) (lapack::sgn 0.0F0) (lapack::smin 0.0F0) (lapack::smlnum 0.0F0) (lapack::tau1 0.0F0) (lapack::temp 0.0F0) (lapack::u11 0.0F0) (lapack::u12 0.0F0) (lapack::u22 0.0F0) (lapack::xmax 0.0F0) (lapack::i 0) (lapack::ip 0) (lapack::ipiv 0) (lapack::ipsv 0) (lapack::j 0) (lapack::jp 0) (lapack::jpsv 0) (lapack::k 0) (lapack::bswap lisp::nil) (lapack::xswap lisp::nil)) (lisp::declare (lisp::type (lisp::array lisp::double-float (16)) lapack::t16) (lisp::type (lisp::array lisp::double-float (4)) lapack::btmp lapack::tmp) (lisp::type (lisp::array lisp::double-float (2)) lapack::x2) (lisp::type (lisp::array f2cl-lib::integer4 (4)) lapack::jpiv) (lisp::type (lisp::double-float) lapack::bet lapack::eps lapack::gam lapack::l21 lapack::sgn lapack::smin lapack::smlnum lapack::tau1 lapack::temp lapack::u11 lapack::u12 lapack::u22 lapack::xmax) (lisp::type (f2cl-lib::integer4) lapack::i lapack::ip lapack::ipiv lapack::ipsv lapack::j lapack::jp lapack::jpsv lapack::k) (lisp::type f2cl-lib::logical lapack::bswap lapack::xswap)) (lisp::setf lapack::info 0) (lisp::if (lisp::or (lisp::= lapack::n1 0) (lisp::= lapack::n2 0)) (lisp::go lapack::end_label)) (lisp::setf lapack::eps (lapack::dlamch "P")) (lisp::setf lapack::smlnum (lisp::/ (lapack::dlamch "S") lapack::eps)) (lisp::setf lapack::sgn (lisp::coerce (lisp::the f2cl-lib::integer4 lapack::isgn) (lisp::quote lisp::double-float))) (lisp::setf lapack::k (f2cl-lib::int-sub (f2cl-lib::int-add lapack::n1 lapack::n1 lapack::n2) 2)) (f2cl-lib::computed-goto (lapack::label10 lapack::label20 lapack::label30 lapack::label50) lapack::k) lapack::label10 (lisp::setf lapack::tau1 (lisp::+ (f2cl-lib::fref lapack::tl-%data% (1 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (1 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)))) (lisp::setf lapack::bet (lisp::abs lapack::tau1)) (lisp::cond ((lisp::<= lapack::bet lapack::smlnum) (lisp::setf lapack::tau1 lapack::smlnum) (lisp::setf lapack::bet lapack::smlnum) (lisp::setf lapack::info 1))) (lisp::setf lapack::scale lapack::one) (lisp::setf lapack::gam (lisp::abs (f2cl-lib::fref lapack::b-%data% (1 1) ((1 lapack::ldb$) (1 lisp::*)) lapack::b-%offset%))) (lisp::if (lisp::> (lisp::* lapack::smlnum lapack::gam) lapack::bet) (lisp::setf lapack::scale (lisp::/ lapack::one lapack::gam))) (lisp::setf (f2cl-lib::fref lapack::x-%data% (1 1) ((1 lapack::ldx) (1 lisp::*)) lapack::x-%offset%) (lisp::/ (lisp::* (f2cl-lib::fref lapack::b-%data% (1 1) ((1 lapack::ldb$) (1 lisp::*)) lapack::b-%offset%) lapack::scale) lapack::tau1)) (lisp::setf lapack::xnorm (lisp::abs (f2cl-lib::fref lapack::x-%data% (1 1) ((1 lapack::ldx) (1 lisp::*)) lapack::x-%offset%))) (lisp::go lapack::end_label) lapack::label20 (lisp::setf lapack::smin (lisp::max (lisp::* lapack::eps (lisp::max (lisp::abs (f2cl-lib::fref lapack::tl-%data% (1 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tr-%data% (1 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tr-%data% (1 2) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tr-%data% (2 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tr-%data% (2 2) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)))) lapack::smlnum)) (lisp::setf (f2cl-lib::fref lapack::tmp (1) ((1 4))) (lisp::+ (f2cl-lib::fref lapack::tl-%data% (1 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (1 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)))) (lisp::setf (f2cl-lib::fref lapack::tmp (4) ((1 4))) (lisp::+ (f2cl-lib::fref lapack::tl-%data% (1 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (2 2) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)))) (lisp::cond (lapack::ltranr (lisp::setf (f2cl-lib::fref lapack::tmp (2) ((1 4))) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (2 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%))) (lisp::setf (f2cl-lib::fref lapack::tmp (3) ((1 4))) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (1 2) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)))) (lisp::t (lisp::setf (f2cl-lib::fref lapack::tmp (2) ((1 4))) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (1 2) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%))) (lisp::setf (f2cl-lib::fref lapack::tmp (3) ((1 4))) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (2 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%))))) (lisp::setf (f2cl-lib::fref lapack::btmp (1) ((1 4))) (f2cl-lib::fref lapack::b-%data% (1 1) ((1 lapack::ldb$) (1 lisp::*)) lapack::b-%offset%)) (lisp::setf (f2cl-lib::fref lapack::btmp (2) ((1 4))) (f2cl-lib::fref lapack::b-%data% (1 2) ((1 lapack::ldb$) (1 lisp::*)) lapack::b-%offset%)) (lisp::go lapack::label40) lapack::label30 (lisp::setf lapack::smin (lisp::max (lisp::* lapack::eps (lisp::max (lisp::abs (f2cl-lib::fref lapack::tr-%data% (1 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tl-%data% (1 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tl-%data% (1 2) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tl-%data% (2 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tl-%data% (2 2) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)))) lapack::smlnum)) (lisp::setf (f2cl-lib::fref lapack::tmp (1) ((1 4))) (lisp::+ (f2cl-lib::fref lapack::tl-%data% (1 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (1 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)))) (lisp::setf (f2cl-lib::fref lapack::tmp (4) ((1 4))) (lisp::+ (f2cl-lib::fref lapack::tl-%data% (2 2) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (1 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)))) (lisp::cond (lapack::ltranl (lisp::setf (f2cl-lib::fref lapack::tmp (2) ((1 4))) (f2cl-lib::fref lapack::tl-%data% (1 2) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::setf (f2cl-lib::fref lapack::tmp (3) ((1 4))) (f2cl-lib::fref lapack::tl-%data% (2 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%))) (lisp::t (lisp::setf (f2cl-lib::fref lapack::tmp (2) ((1 4))) (f2cl-lib::fref lapack::tl-%data% (2 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::setf (f2cl-lib::fref lapack::tmp (3) ((1 4))) (f2cl-lib::fref lapack::tl-%data% (1 2) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)))) (lisp::setf (f2cl-lib::fref lapack::btmp (1) ((1 4))) (f2cl-lib::fref lapack::b-%data% (1 1) ((1 lapack::ldb$) (1 lisp::*)) lapack::b-%offset%)) (lisp::setf (f2cl-lib::fref lapack::btmp (2) ((1 4))) (f2cl-lib::fref lapack::b-%data% (2 1) ((1 lapack::ldb$) (1 lisp::*)) lapack::b-%offset%)) lapack::label40 (lisp::setf lapack::ipiv (blas::idamax 4 lapack::tmp 1)) (lisp::setf lapack::u11 (f2cl-lib::fref lapack::tmp (lapack::ipiv) ((1 4)))) (lisp::cond ((lisp::<= (lisp::abs lapack::u11) lapack::smin) (lisp::setf lapack::info 1) (lisp::setf lapack::u11 lapack::smin))) (lisp::setf lapack::u12 (f2cl-lib::fref lapack::tmp ((f2cl-lib::fref lapack::locu12 (lapack::ipiv) ((1 4)))) ((1 4)))) (lisp::setf lapack::l21 (lisp::/ (f2cl-lib::fref lapack::tmp ((f2cl-lib::fref lapack::locl21 (lapack::ipiv) ((1 4)))) ((1 4))) lapack::u11)) (lisp::setf lapack::u22 (lisp::- (f2cl-lib::fref lapack::tmp ((f2cl-lib::fref lapack::locu22 (lapack::ipiv) ((1 4)))) ((1 4))) (lisp::* lapack::u12 lapack::l21))) (lisp::setf lapack::xswap (f2cl-lib::fref lapack::xswpiv (lapack::ipiv) ((1 4)))) (lisp::setf lapack::bswap (f2cl-lib::fref lapack::bswpiv (lapack::ipiv) ((1 4)))) (lisp::cond ((lisp::<= (lisp::abs lapack::u22) lapack::smin) (lisp::setf lapack::info 1) (lisp::setf lapack::u22 lapack::smin))) (lisp::cond (lapack::bswap (lisp::setf lapack::temp (f2cl-lib::fref lapack::btmp (2) ((1 4)))) (lisp::setf (f2cl-lib::fref lapack::btmp (2) ((1 4))) (lisp::- (f2cl-lib::fref lapack::btmp (1) ((1 4))) (lisp::* lapack::l21 lapack::temp))) (lisp::setf (f2cl-lib::fref lapack::btmp (1) ((1 4))) lapack::temp)) (lisp::t (lisp::setf (f2cl-lib::fref lapack::btmp (2) ((1 4))) (lisp::- (f2cl-lib::fref lapack::btmp (2) ((1 4))) (lisp::* lapack::l21 (f2cl-lib::fref lapack::btmp (1) ((1 4)))))))) (lisp::setf lapack::scale lapack::one) (lisp::cond ((lisp::or (lisp::> (lisp::* lapack::two lapack::smlnum (lisp::abs (f2cl-lib::fref lapack::btmp (2) ((1 4))))) (lisp::abs lapack::u22)) (lisp::> (lisp::* lapack::two lapack::smlnum (lisp::abs (f2cl-lib::fref lapack::btmp (1) ((1 4))))) (lisp::abs lapack::u11))) (lisp::setf lapack::scale (lisp::/ lapack::half (lisp::max (lisp::abs (f2cl-lib::fref lapack::btmp (1) ((1 4)))) (lisp::abs (f2cl-lib::fref lapack::btmp (2) ((1 4))))))) (lisp::setf (f2cl-lib::fref lapack::btmp (1) ((1 4))) (lisp::* (f2cl-lib::fref lapack::btmp (1) ((1 4))) lapack::scale)) (lisp::setf (f2cl-lib::fref lapack::btmp (2) ((1 4))) (lisp::* (f2cl-lib::fref lapack::btmp (2) ((1 4))) lapack::scale)))) (lisp::setf (f2cl-lib::fref lapack::x2 (2) ((1 2))) (lisp::/ (f2cl-lib::fref lapack::btmp (2) ((1 4))) lapack::u22)) (lisp::setf (f2cl-lib::fref lapack::x2 (1) ((1 2))) (lisp::- (lisp::/ (f2cl-lib::fref lapack::btmp (1) ((1 4))) lapack::u11) (lisp::* (lisp::/ lapack::u12 lapack::u11) (f2cl-lib::fref lapack::x2 (2) ((1 2)))))) (lisp::cond (lapack::xswap (lisp::setf lapack::temp (f2cl-lib::fref lapack::x2 (2) ((1 2)))) (lisp::setf (f2cl-lib::fref lapack::x2 (2) ((1 2))) (f2cl-lib::fref lapack::x2 (1) ((1 2)))) (lisp::setf (f2cl-lib::fref lapack::x2 (1) ((1 2))) lapack::temp))) (lisp::setf (f2cl-lib::fref lapack::x-%data% (1 1) ((1 lapack::ldx) (1 lisp::*)) lapack::x-%offset%) (f2cl-lib::fref lapack::x2 (1) ((1 2)))) (lisp::cond ((lisp::= lapack::n1 1) (lisp::setf (f2cl-lib::fref lapack::x-%data% (1 2) ((1 lapack::ldx) (1 lisp::*)) lapack::x-%offset%) (f2cl-lib::fref lapack::x2 (2) ((1 2)))) (lisp::setf lapack::xnorm (lisp::+ (lisp::abs (f2cl-lib::fref lapack::x-%data% (1 1) ((1 lapack::ldx) (1 lisp::*)) lapack::x-%offset%)) (lisp::abs (f2cl-lib::fref lapack::x-%data% (1 2) ((1 lapack::ldx) (1 lisp::*)) lapack::x-%offset%))))) (lisp::t (lisp::setf (f2cl-lib::fref lapack::x-%data% (2 1) ((1 lapack::ldx) (1 lisp::*)) lapack::x-%offset%) (f2cl-lib::fref lapack::x2 (2) ((1 2)))) (lisp::setf lapack::xnorm (lisp::max (lisp::abs (f2cl-lib::fref lapack::x-%data% (1 1) ((1 lapack::ldx) (1 lisp::*)) lapack::x-%offset%)) (lisp::abs (f2cl-lib::fref lapack::x-%data% (2 1) ((1 lapack::ldx) (1 lisp::*)) lapack::x-%offset%)))))) (lisp::go lapack::end_label) lapack::label50 (lisp::setf lapack::smin (lisp::max (lisp::abs (f2cl-lib::fref lapack::tr-%data% (1 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tr-%data% (1 2) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tr-%data% (2 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tr-%data% (2 2) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)))) (lisp::setf lapack::smin (lisp::max lapack::smin (lisp::abs (f2cl-lib::fref lapack::tl-%data% (1 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tl-%data% (1 2) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tl-%data% (2 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::abs (f2cl-lib::fref lapack::tl-%data% (2 2) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)))) (lisp::setf lapack::smin (lisp::max (lisp::* lapack::eps lapack::smin) lapack::smlnum)) (lisp::setf (f2cl-lib::fref lapack::btmp (1) ((1 4))) lapack::zero) (blas::dcopy 16 lapack::btmp 0 lapack::t16 1) (lisp::setf (f2cl-lib::fref lapack::t16 (1 1) ((1 4) (1 4))) (lisp::+ (f2cl-lib::fref lapack::tl-%data% (1 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (1 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)))) (lisp::setf (f2cl-lib::fref lapack::t16 (2 2) ((1 4) (1 4))) (lisp::+ (f2cl-lib::fref lapack::tl-%data% (2 2) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (1 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)))) (lisp::setf (f2cl-lib::fref lapack::t16 (3 3) ((1 4) (1 4))) (lisp::+ (f2cl-lib::fref lapack::tl-%data% (1 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (2 2) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)))) (lisp::setf (f2cl-lib::fref lapack::t16 (4 4) ((1 4) (1 4))) (lisp::+ (f2cl-lib::fref lapack::tl-%data% (2 2) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (2 2) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)))) (lisp::cond (lapack::ltranl (lisp::setf (f2cl-lib::fref lapack::t16 (1 2) ((1 4) (1 4))) (f2cl-lib::fref lapack::tl-%data% (2 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::setf (f2cl-lib::fref lapack::t16 (2 1) ((1 4) (1 4))) (f2cl-lib::fref lapack::tl-%data% (1 2) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::setf (f2cl-lib::fref lapack::t16 (3 4) ((1 4) (1 4))) (f2cl-lib::fref lapack::tl-%data% (2 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::setf (f2cl-lib::fref lapack::t16 (4 3) ((1 4) (1 4))) (f2cl-lib::fref lapack::tl-%data% (1 2) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%))) (lisp::t (lisp::setf (f2cl-lib::fref lapack::t16 (1 2) ((1 4) (1 4))) (f2cl-lib::fref lapack::tl-%data% (1 2) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::setf (f2cl-lib::fref lapack::t16 (2 1) ((1 4) (1 4))) (f2cl-lib::fref lapack::tl-%data% (2 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::setf (f2cl-lib::fref lapack::t16 (3 4) ((1 4) (1 4))) (f2cl-lib::fref lapack::tl-%data% (1 2) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)) (lisp::setf (f2cl-lib::fref lapack::t16 (4 3) ((1 4) (1 4))) (f2cl-lib::fref lapack::tl-%data% (2 1) ((1 lapack::ldtl) (1 lisp::*)) lapack::tl-%offset%)))) (lisp::cond (lapack::ltranr (lisp::setf (f2cl-lib::fref lapack::t16 (1 3) ((1 4) (1 4))) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (1 2) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%))) (lisp::setf (f2cl-lib::fref lapack::t16 (2 4) ((1 4) (1 4))) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (1 2) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%))) (lisp::setf (f2cl-lib::fref lapack::t16 (3 1) ((1 4) (1 4))) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (2 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%))) (lisp::setf (f2cl-lib::fref lapack::t16 (4 2) ((1 4) (1 4))) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (2 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%)))) (lisp::t (lisp::setf (f2cl-lib::fref lapack::t16 (1 3) ((1 4) (1 4))) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (2 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%))) (lisp::setf (f2cl-lib::fref lapack::t16 (2 4) ((1 4) (1 4))) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (2 1) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%))) (lisp::setf (f2cl-lib::fref lapack::t16 (3 1) ((1 4) (1 4))) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (1 2) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%))) (lisp::setf (f2cl-lib::fref lapack::t16 (4 2) ((1 4) (1 4))) (lisp::* lapack::sgn (f2cl-lib::fref lapack::tr-%data% (1 2) ((1 lapack::ldtr) (1 lisp::*)) lapack::tr-%offset%))))) (lisp::setf (f2cl-lib::fref lapack::btmp (1) ((1 4))) (f2cl-lib::fref lapack::b-%data% (1 1) ((1 lapack::ldb$) (1 lisp::*)) lapack::b-%offset%)) (lisp::setf (f2cl-lib::fref lapack::btmp (2) ((1 4))) (f2cl-lib::fref lapack::b-%data% (2 1) ((1 lapack::ldb$) (1 lisp::*)) lapack::b-%offset%)) (lisp::setf (f2cl-lib::fref lapack::btmp (3) ((1 4))) (f2cl-lib::fref lapack::b-%data% (1 2) ((1 lapack::ldb$) (1 lisp::*)) lapack::b-%offset%)) (lisp::setf (f2cl-lib::fref lapack::btmp (4) ((1 4))) (f2cl-lib::fref lapack::b-%data% (2 2) ((1 lapack::ldb$) (1 lisp::*)) lapack::b-%offset%)) (f2cl-lib::fdo (lapack::i 1 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i 3) lisp::nil) (lisp::tagbody (lisp::setf lapack::xmax lapack::zero) (f2cl-lib::fdo (lapack::ip lapack::i (f2cl-lib::int-add lapack::ip 1)) ((lisp::> lapack::ip 4) lisp::nil) (lisp::tagbody (f2cl-lib::fdo (lapack::jp lapack::i (f2cl-lib::int-add lapack::jp 1)) ((lisp::> lapack::jp 4) lisp::nil) (lisp::tagbody (lisp::cond ((lisp::>= (lisp::abs (f2cl-lib::fref lapack::t16 (lapack::ip lapack::jp) ((1 4) (1 4)))) lapack::xmax) (lisp::setf lapack::xmax (lisp::abs (f2cl-lib::fref lapack::t16 (lapack::ip lapack::jp) ((1 4) (1 4))))) (lisp::setf lapack::ipsv lapack::ip) (lisp::setf lapack::jpsv lapack::jp))) lapack::label60)) lapack::label70)) (lisp::cond ((lisp::/= lapack::ipsv lapack::i) (blas::dswap 4 (f2cl-lib::array-slice lapack::t16 lisp::double-float (lapack::ipsv 1) ((1 4) (1 4))) 4 (f2cl-lib::array-slice lapack::t16 lisp::double-float (lapack::i 1) ((1 4) (1 4))) 4) (lisp::setf lapack::temp (f2cl-lib::fref lapack::btmp (lapack::i) ((1 4)))) (lisp::setf (f2cl-lib::fref lapack::btmp (lapack::i) ((1 4))) (f2cl-lib::fref lapack::btmp (lapack::ipsv) ((1 4)))) (lisp::setf (f2cl-lib::fref lapack::btmp (lapack::ipsv) ((1 4))) lapack::temp))) (lisp::if (lisp::/= lapack::jpsv lapack::i) (blas::dswap 4 (f2cl-lib::array-slice lapack::t16 lisp::double-float (1 lapack::jpsv) ((1 4) (1 4))) 1 (f2cl-lib::array-slice lapack::t16 lisp::double-float (1 lapack::i) ((1 4) (1 4))) 1)) (lisp::setf (f2cl-lib::fref lapack::jpiv (lapack::i) ((1 4))) lapack::jpsv) (lisp::cond ((lisp::< (lisp::abs (f2cl-lib::fref lapack::t16 (lapack::i lapack::i) ((1 4) (1 4)))) lapack::smin) (lisp::setf lapack::info 1) (lisp::setf (f2cl-lib::fref lapack::t16 (lapack::i lapack::i) ((1 4) (1 4))) lapack::smin))) (f2cl-lib::fdo (lapack::j (f2cl-lib::int-add lapack::i 1) (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j 4) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::t16 (lapack::j lapack::i) ((1 4) (1 4))) (lisp::/ (f2cl-lib::fref lapack::t16 (lapack::j lapack::i) ((1 4) (1 4))) (f2cl-lib::fref lapack::t16 (lapack::i lapack::i) ((1 4) (1 4))))) (lisp::setf (f2cl-lib::fref lapack::btmp (lapack::j) ((1 4))) (lisp::- (f2cl-lib::fref lapack::btmp (lapack::j) ((1 4))) (lisp::* (f2cl-lib::fref lapack::t16 (lapack::j lapack::i) ((1 4) (1 4))) (f2cl-lib::fref lapack::btmp (lapack::i) ((1 4)))))) (f2cl-lib::fdo (lapack::k (f2cl-lib::int-add lapack::i 1) (f2cl-lib::int-add lapack::k 1)) ((lisp::> lapack::k 4) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::t16 (lapack::j lapack::k) ((1 4) (1 4))) (lisp::- (f2cl-lib::fref lapack::t16 (lapack::j lapack::k) ((1 4) (1 4))) (lisp::* (f2cl-lib::fref lapack::t16 (lapack::j lapack::i) ((1 4) (1 4))) (f2cl-lib::fref lapack::t16 (lapack::i lapack::k) ((1 4) (1 4)))))) lapack::label80)) lapack::label90)) lapack::label100)) (lisp::if (lisp::< (lisp::abs (f2cl-lib::fref lapack::t16 (4 4) ((1 4) (1 4)))) lapack::smin) (lisp::setf (f2cl-lib::fref lapack::t16 (4 4) ((1 4) (1 4))) lapack::smin)) (lisp::setf lapack::scale lapack::one) (lisp::cond ((lisp::or (lisp::> (lisp::* lapack::eight lapack::smlnum (lisp::abs (f2cl-lib::fref lapack::btmp (1) ((1 4))))) (lisp::abs (f2cl-lib::fref lapack::t16 (1 1) ((1 4) (1 4))))) (lisp::> (lisp::* lapack::eight lapack::smlnum (lisp::abs (f2cl-lib::fref lapack::btmp (2) ((1 4))))) (lisp::abs (f2cl-lib::fref lapack::t16 (2 2) ((1 4) (1 4))))) (lisp::> (lisp::* lapack::eight lapack::smlnum (lisp::abs (f2cl-lib::fref lapack::btmp (3) ((1 4))))) (lisp::abs (f2cl-lib::fref lapack::t16 (3 3) ((1 4) (1 4))))) (lisp::> (lisp::* lapack::eight lapack::smlnum (lisp::abs (f2cl-lib::fref lapack::btmp (4) ((1 4))))) (lisp::abs (f2cl-lib::fref lapack::t16 (4 4) ((1 4) (1 4)))))) (lisp::setf lapack::scale (lisp::/ (lisp::/ lapack::one lapack::eight) (lisp::max (lisp::abs (f2cl-lib::fref lapack::btmp (1) ((1 4)))) (lisp::abs (f2cl-lib::fref lapack::btmp (2) ((1 4)))) (lisp::abs (f2cl-lib::fref lapack::btmp (3) ((1 4)))) (lisp::abs (f2cl-lib::fref lapack::btmp (4) ((1 4))))))) (lisp::setf (f2cl-lib::fref lapack::btmp (1) ((1 4))) (lisp::* (f2cl-lib::fref lapack::btmp (1) ((1 4))) lapack::scale)) (lisp::setf (f2cl-lib::fref lapack::btmp (2) ((1 4))) (lisp::* (f2cl-lib::fref lapack::btmp (2) ((1 4))) lapack::scale)) (lisp::setf (f2cl-lib::fref lapack::btmp (3) ((1 4))) (lisp::* (f2cl-lib::fref lapack::btmp (3) ((1 4))) lapack::scale)) (lisp::setf (f2cl-lib::fref lapack::btmp (4) ((1 4))) (lisp::* (f2cl-lib::fref lapack::btmp (4) ((1 4))) lapack::scale)))) (f2cl-lib::fdo (lapack::i 1 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i 4) lisp::nil) (lisp::tagbody (lisp::setf lapack::k (f2cl-lib::int-sub 5 lapack::i)) (lisp::setf lapack::temp (lisp::/ lapack::one (f2cl-lib::fref lapack::t16 (lapack::k lapack::k) ((1 4) (1 4))))) (lisp::setf (f2cl-lib::fref lapack::tmp (lapack::k) ((1 4))) (lisp::* (f2cl-lib::fref lapack::btmp (lapack::k) ((1 4))) lapack::temp)) (f2cl-lib::fdo (lapack::j (f2cl-lib::int-add lapack::k 1) (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j 4) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::tmp (lapack::k) ((1 4))) (lisp::- (f2cl-lib::fref lapack::tmp (lapack::k) ((1 4))) (lisp::* lapack::temp (f2cl-lib::fref lapack::t16 (lapack::k lapack::j) ((1 4) (1 4))) (f2cl-lib::fref lapack::tmp (lapack::j) ((1 4)))))) lapack::label110)) lapack::label120)) (f2cl-lib::fdo (lapack::i 1 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i 3) lisp::nil) (lisp::tagbody (lisp::cond ((lisp::/= (f2cl-lib::fref lapack::jpiv ((f2cl-lib::int-add 4 (f2cl-lib::int-sub lapack::i))) ((1 4))) (f2cl-lib::int-add 4 (f2cl-lib::int-sub lapack::i))) (lisp::setf lapack::temp (f2cl-lib::fref lapack::tmp ((f2cl-lib::int-sub 4 lapack::i)) ((1 4)))) (lisp::setf (f2cl-lib::fref lapack::tmp ((f2cl-lib::int-sub 4 lapack::i)) ((1 4))) (f2cl-lib::fref lapack::tmp ((f2cl-lib::fref lapack::jpiv ((f2cl-lib::int-sub 4 lapack::i)) ((1 4)))) ((1 4)))) (lisp::setf (f2cl-lib::fref lapack::tmp ((f2cl-lib::fref lapack::jpiv ((f2cl-lib::int-sub 4 lapack::i)) ((1 4)))) ((1 4))) lapack::temp))) lapack::label130)) (lisp::setf (f2cl-lib::fref lapack::x-%data% (1 1) ((1 lapack::ldx) (1 lisp::*)) lapack::x-%offset%) (f2cl-lib::fref lapack::tmp (1) ((1 4)))) (lisp::setf (f2cl-lib::fref lapack::x-%data% (2 1) ((1 lapack::ldx) (1 lisp::*)) lapack::x-%offset%) (f2cl-lib::fref lapack::tmp (2) ((1 4)))) (lisp::setf (f2cl-lib::fref lapack::x-%data% (1 2) ((1 lapack::ldx) (1 lisp::*)) lapack::x-%offset%) (f2cl-lib::fref lapack::tmp (3) ((1 4)))) (lisp::setf (f2cl-lib::fref lapack::x-%data% (2 2) ((1 lapack::ldx) (1 lisp::*)) lapack::x-%offset%) (f2cl-lib::fref lapack::tmp (4) ((1 4)))) (lisp::setf lapack::xnorm (lisp::max (lisp::+ (lisp::abs (f2cl-lib::fref lapack::tmp (1) ((1 4)))) (lisp::abs (f2cl-lib::fref lapack::tmp (3) ((1 4))))) (lisp::+ (lisp::abs (f2cl-lib::fref lapack::tmp (2) ((1 4)))) (lisp::abs (f2cl-lib::fref lapack::tmp (4) ((1 4))))))) (lisp::go lapack::end_label) lapack::end_label (lisp::return (lisp::values lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lapack::scale lisp::nil lisp::nil lapack::xnorm lapack::info))))))))))
)
