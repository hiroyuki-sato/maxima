       
#(#! 
(lisp::in-package :lapack)#! 
(lisp::in-package "CL-USER")
#((system::%init . #((lisp::let* ((lapack::zero 0.0F0) (lapack::one 1.0F0) (lapack::two 2.0F0) (lapack::const 1.5F0) (lapack::nsmax 15) (lapack::lds lapack::nsmax)) (lisp::declare (lisp::type (lisp::double-float 0.0F0 0.0F0) lapack::zero) (lisp::type (lisp::double-float 1.0F0 1.0F0) lapack::one) (lisp::type (lisp::double-float 2.0F0 2.0F0) lapack::two) (lisp::type (lisp::double-float 1.5F0 1.5F0) lapack::const) (lisp::type (f2cl-lib::integer4 15 15) lapack::nsmax) (lisp::type (f2cl-lib::integer4) lapack::lds) (lisp::ignorable lapack::zero lapack::one lapack::two lapack::const lapack::nsmax lapack::lds)) (lisp::defun lapack::dhseqr (lapack::job lapack::compz lapack::n lapack::ilo lapack::ihi lapack::h lapack::ldh lapack::wr lapack::wi lapack::z lapack::ldz lapack::work lapack::lwork lapack::info) (lisp::declare (lisp::type (lisp::array lisp::double-float (lisp::*)) lapack::work lapack::z lapack::wi lapack::wr lapack::h) (lisp::type (f2cl-lib::integer4) lapack::info lapack::lwork lapack::ldz lapack::ldh lapack::ihi lapack::ilo lapack::n) (lisp::type (lisp::simple-array lisp::character (lisp::*)) lapack::compz lapack::job)) (f2cl-lib::with-multi-array-data ((lapack::job lisp::character lapack::job-%data% lapack::job-%offset%) (lapack::compz lisp::character lapack::compz-%data% lapack::compz-%offset%) (lapack::h lisp::double-float lapack::h-%data% lapack::h-%offset%) (lapack::wr lisp::double-float lapack::wr-%data% lapack::wr-%offset%) (lapack::wi lisp::double-float lapack::wi-%data% lapack::wi-%offset%) (lapack::z lisp::double-float lapack::z-%data% lapack::z-%offset%) (lapack::work lisp::double-float lapack::work-%data% lapack::work-%offset%)) (lisp::prog ((lapack::s (lisp::make-array (lisp::the lisp::fixnum (lisp::reduce (lisp::function lisp::*) (lisp::list lapack::lds lapack::nsmax))) :element-type (lisp::quote lisp::double-float))) (lapack::v (lisp::make-array (f2cl-lib::int-add lapack::nsmax 1) :element-type (lisp::quote lisp::double-float))) (lapack::vv (lisp::make-array (f2cl-lib::int-add lapack::nsmax 1) :element-type (lisp::quote lisp::double-float))) (lapack::absw 0.0F0) (lapack::ovfl 0.0F0) (lapack::smlnum 0.0F0) (lapack::tau 0.0F0) (lapack::temp 0.0F0) (lapack::tst1 0.0F0) (lapack::ulp 0.0F0) (lapack::unfl 0.0F0) (lapack::i 0) (lapack::i1 0) (lapack::i2 0) (lapack::ierr 0) (lapack::ii 0) (lapack::itemp 0) (lapack::itn 0) (lapack::its 0) (lapack::j 0) (lapack::k 0) (lapack::l 0) (lapack::maxb 0) (lapack::nh 0) (lapack::nr 0) (lapack::ns 0) (lapack::nv 0) (lapack::initz lisp::nil) (lapack::lquery lisp::nil) (lapack::wantt lisp::nil) (lapack::wantz lisp::nil)) (lisp::declare (lisp::type (lisp::array lisp::double-float (lisp::*)) lapack::s lapack::v lapack::vv) (lisp::type (lisp::double-float) lapack::absw lapack::ovfl lapack::smlnum lapack::tau lapack::temp lapack::tst1 lapack::ulp lapack::unfl) (lisp::type (f2cl-lib::integer4) lapack::i lapack::i1 lapack::i2 lapack::ierr lapack::ii lapack::itemp lapack::itn lapack::its lapack::j lapack::k lapack::l lapack::maxb lapack::nh lapack::nr lapack::ns lapack::nv) (lisp::type f2cl-lib::logical lapack::initz lapack::lquery lapack::wantt lapack::wantz)) (lisp::setf lapack::wantt (blas::lsame lapack::job "S")) (lisp::setf lapack::initz (blas::lsame lapack::compz "I")) (lisp::setf lapack::wantz (lisp::or lapack::initz (blas::lsame lapack::compz "V"))) (lisp::setf lapack::info 0) (lisp::setf (f2cl-lib::fref lapack::work-%data% (1) ((1 lisp::*)) lapack::work-%offset%) (lisp::coerce (lisp::the f2cl-lib::integer4 (lisp::max (lisp::the f2cl-lib::integer4 1) (lisp::the f2cl-lib::integer4 lapack::n))) (lisp::quote lisp::double-float))) (lisp::setf lapack::lquery (lisp::coerce (lisp::= lapack::lwork -1) (lisp::quote f2cl-lib::logical))) (lisp::cond ((lisp::and (lisp::not (blas::lsame lapack::job "E")) (lisp::not lapack::wantt)) (lisp::setf lapack::info -1)) ((lisp::and (lisp::not (blas::lsame lapack::compz "N")) (lisp::not lapack::wantz)) (lisp::setf lapack::info -2)) ((lisp::< lapack::n 0) (lisp::setf lapack::info -3)) ((lisp::or (lisp::< lapack::ilo 1) (lisp::> lapack::ilo (lisp::max (lisp::the f2cl-lib::integer4 1) (lisp::the f2cl-lib::integer4 lapack::n)))) (lisp::setf lapack::info -4)) ((lisp::or (lisp::< lapack::ihi (lisp::min (lisp::the f2cl-lib::integer4 lapack::ilo) (lisp::the f2cl-lib::integer4 lapack::n))) (lisp::> lapack::ihi lapack::n)) (lisp::setf lapack::info -5)) ((lisp::< lapack::ldh (lisp::max (lisp::the f2cl-lib::integer4 1) (lisp::the f2cl-lib::integer4 lapack::n))) (lisp::setf lapack::info -7)) ((lisp::or (lisp::< lapack::ldz 1) (lisp::and lapack::wantz (lisp::< lapack::ldz (lisp::max (lisp::the f2cl-lib::integer4 1) (lisp::the f2cl-lib::integer4 lapack::n))))) (lisp::setf lapack::info -11)) ((lisp::and (lisp::< lapack::lwork (lisp::max (lisp::the f2cl-lib::integer4 1) (lisp::the f2cl-lib::integer4 lapack::n))) (lisp::not lapack::lquery)) (lisp::setf lapack::info -13))) (lisp::cond ((lisp::/= lapack::info 0) (blas::xerbla "DHSEQR" (f2cl-lib::int-sub lapack::info)) (lisp::go lapack::end_label)) (lapack::lquery (lisp::go lapack::end_label))) (lisp::if lapack::initz (lapack::dlaset "Full" lapack::n lapack::n lapack::zero lapack::one lapack::z lapack::ldz)) (f2cl-lib::fdo (lapack::i 1 (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i (f2cl-lib::int-add lapack::ilo (f2cl-lib::int-sub 1))) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::wr-%data% (lapack::i) ((1 lisp::*)) lapack::wr-%offset%) (f2cl-lib::fref lapack::h-%data% (lapack::i lapack::i) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf (f2cl-lib::fref lapack::wi-%data% (lapack::i) ((1 lisp::*)) lapack::wi-%offset%) lapack::zero) lapack::label10)) (f2cl-lib::fdo (lapack::i (f2cl-lib::int-add lapack::ihi 1) (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::n) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::wr-%data% (lapack::i) ((1 lisp::*)) lapack::wr-%offset%) (f2cl-lib::fref lapack::h-%data% (lapack::i lapack::i) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf (f2cl-lib::fref lapack::wi-%data% (lapack::i) ((1 lisp::*)) lapack::wi-%offset%) lapack::zero) lapack::label20)) (lisp::if (lisp::= lapack::n 0) (lisp::go lapack::end_label)) (lisp::cond ((lisp::= lapack::ilo lapack::ihi) (lisp::setf (f2cl-lib::fref lapack::wr-%data% (lapack::ilo) ((1 lisp::*)) lapack::wr-%offset%) (f2cl-lib::fref lapack::h-%data% (lapack::ilo lapack::ilo) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::setf (f2cl-lib::fref lapack::wi-%data% (lapack::ilo) ((1 lisp::*)) lapack::wi-%offset%) lapack::zero) (lisp::go lapack::end_label))) (f2cl-lib::fdo (lapack::j lapack::ilo (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j (f2cl-lib::int-add lapack::ihi (f2cl-lib::int-sub 2))) lisp::nil) (lisp::tagbody (f2cl-lib::fdo (lapack::i (f2cl-lib::int-add lapack::j 2) (f2cl-lib::int-add lapack::i 1)) ((lisp::> lapack::i lapack::n) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::i lapack::j) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) lapack::zero) lapack::label30)) lapack::label40)) (lisp::setf lapack::nh (f2cl-lib::int-add (f2cl-lib::int-sub lapack::ihi lapack::ilo) 1)) (lisp::setf lapack::ns (lapack::ilaenv 4 "DHSEQR" (f2cl-lib::f2cl-// lapack::job lapack::compz) lapack::n lapack::ilo lapack::ihi -1)) (lisp::setf lapack::maxb (lapack::ilaenv 8 "DHSEQR" (f2cl-lib::f2cl-// lapack::job lapack::compz) lapack::n lapack::ilo lapack::ihi -1)) (lisp::cond ((lisp::or (lisp::<= lapack::ns 2) (lisp::> lapack::ns lapack::nh) (lisp::>= lapack::maxb lapack::nh)) (lisp::multiple-value-bind (lapack::var-0 lapack::var-1 lapack::var-2 lapack::var-3 lapack::var-4 lapack::var-5 lapack::var-6 lapack::var-7 lapack::var-8 lapack::var-9 lapack::var-10 lapack::var-11 lapack::var-12 lapack::var-13) (lapack::dlahqr lapack::wantt lapack::wantz lapack::n lapack::ilo lapack::ihi lapack::h lapack::ldh lapack::wr lapack::wi lapack::ilo lapack::ihi lapack::z lapack::ldz lapack::info) (lisp::declare (lisp::ignore lapack::var-0 lapack::var-1 lapack::var-2 lapack::var-3 lapack::var-4 lapack::var-5 lapack::var-6 lapack::var-7 lapack::var-8 lapack::var-9 lapack::var-10 lapack::var-11 lapack::var-12)) (lisp::setf lapack::info lapack::var-13)) (lisp::go lapack::end_label))) (lisp::setf lapack::maxb (lisp::max (lisp::the f2cl-lib::integer4 3) (lisp::the f2cl-lib::integer4 lapack::maxb))) (lisp::setf lapack::ns (lisp::min (lisp::the f2cl-lib::integer4 lapack::ns) (lisp::the f2cl-lib::integer4 lapack::maxb) (lisp::the f2cl-lib::integer4 lapack::nsmax))) (lisp::setf lapack::unfl (lapack::dlamch "Safe minimum")) (lisp::setf lapack::ovfl (lisp::/ lapack::one lapack::unfl)) (lisp::multiple-value-bind (lapack::var-0 lapack::var-1) (lapack::dlabad lapack::unfl lapack::ovfl) (lisp::declare (lisp::ignore)) (lisp::setf lapack::unfl lapack::var-0) (lisp::setf lapack::ovfl lapack::var-1)) (lisp::setf lapack::ulp (lapack::dlamch "Precision")) (lisp::setf lapack::smlnum (lisp::* lapack::unfl (lisp::/ lapack::nh lapack::ulp))) (lisp::cond (lapack::wantt (lisp::setf lapack::i1 1) (lisp::setf lapack::i2 lapack::n))) (lisp::setf lapack::itn (f2cl-lib::int-mul 30 lapack::nh)) (lisp::setf lapack::i lapack::ihi) lapack::label50 (lisp::setf lapack::l lapack::ilo) (lisp::if (lisp::< lapack::i lapack::ilo) (lisp::go lapack::label170)) (f2cl-lib::fdo (lapack::its 0 (f2cl-lib::int-add lapack::its 1)) ((lisp::> lapack::its lapack::itn) lisp::nil) (lisp::tagbody (f2cl-lib::fdo (lapack::k lapack::i (f2cl-lib::int-add lapack::k (f2cl-lib::int-sub 1))) ((lisp::> lapack::k (f2cl-lib::int-add lapack::l 1)) lisp::nil) (lisp::tagbody (lisp::setf lapack::tst1 (lisp::+ (lisp::abs (f2cl-lib::fref lapack::h-%data% ((f2cl-lib::int-sub lapack::k 1) (f2cl-lib::int-sub lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::abs (f2cl-lib::fref lapack::h-%data% (lapack::k lapack::k) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)))) (lisp::if (lisp::= lapack::tst1 lapack::zero) (lisp::setf lapack::tst1 (lapack::dlanhs "1" (f2cl-lib::int-add (f2cl-lib::int-sub lapack::i lapack::l) 1) (f2cl-lib::array-slice lapack::h lisp::double-float (lapack::l lapack::l) ((1 lapack::ldh) (1 lisp::*))) lapack::ldh lapack::work))) (lisp::if (lisp::<= (lisp::abs (f2cl-lib::fref lapack::h-%data% (lapack::k (f2cl-lib::int-sub lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::max (lisp::* lapack::ulp lapack::tst1) lapack::smlnum)) (lisp::go lapack::label70)) lapack::label60)) lapack::label70 (lisp::setf lapack::l lapack::k) (lisp::cond ((lisp::> lapack::l lapack::ilo) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::l (f2cl-lib::int-sub lapack::l 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) lapack::zero))) (lisp::if (lisp::>= lapack::l (f2cl-lib::int-add (f2cl-lib::int-sub lapack::i lapack::maxb) 1)) (lisp::go lapack::label160)) (lisp::cond ((lisp::not lapack::wantt) (lisp::setf lapack::i1 lapack::l) (lisp::setf lapack::i2 lapack::i))) (lisp::cond ((lisp::or (lisp::= lapack::its 20) (lisp::= lapack::its 30)) (f2cl-lib::fdo (lapack::ii (f2cl-lib::int-add lapack::i (f2cl-lib::int-sub lapack::ns) 1) (f2cl-lib::int-add lapack::ii 1)) ((lisp::> lapack::ii lapack::i) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::wr-%data% (lapack::ii) ((1 lisp::*)) lapack::wr-%offset%) (lisp::* lapack::const (lisp::+ (lisp::abs (f2cl-lib::fref lapack::h-%data% (lapack::ii (f2cl-lib::int-sub lapack::ii 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%)) (lisp::abs (f2cl-lib::fref lapack::h-%data% (lapack::ii lapack::ii) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%))))) (lisp::setf (f2cl-lib::fref lapack::wi-%data% (lapack::ii) ((1 lisp::*)) lapack::wi-%offset%) lapack::zero) lapack::label80))) (lisp::t (lapack::dlacpy "Full" lapack::ns lapack::ns (f2cl-lib::array-slice lapack::h lisp::double-float ((lisp::+ lapack::i (f2cl-lib::int-sub lapack::ns) 1) (f2cl-lib::int-add (f2cl-lib::int-sub lapack::i lapack::ns) 1)) ((1 lapack::ldh) (1 lisp::*))) lapack::ldh lapack::s lapack::lds) (lisp::multiple-value-bind (lapack::var-0 lapack::var-1 lapack::var-2 lapack::var-3 lapack::var-4 lapack::var-5 lapack::var-6 lapack::var-7 lapack::var-8 lapack::var-9 lapack::var-10 lapack::var-11 lapack::var-12 lapack::var-13) (lapack::dlahqr f2cl-lib::%false% f2cl-lib::%false% lapack::ns 1 lapack::ns lapack::s lapack::lds (f2cl-lib::array-slice lapack::wr lisp::double-float ((lisp::+ lapack::i (f2cl-lib::int-sub lapack::ns) 1)) ((1 lisp::*))) (f2cl-lib::array-slice lapack::wi lisp::double-float ((lisp::+ lapack::i (f2cl-lib::int-sub lapack::ns) 1)) ((1 lisp::*))) 1 lapack::ns lapack::z lapack::ldz lapack::ierr) (lisp::declare (lisp::ignore lapack::var-0 lapack::var-1 lapack::var-2 lapack::var-3 lapack::var-4 lapack::var-5 lapack::var-6 lapack::var-7 lapack::var-8 lapack::var-9 lapack::var-10 lapack::var-11 lapack::var-12)) (lisp::setf lapack::ierr lapack::var-13)) (lisp::cond ((lisp::> lapack::ierr 0) (f2cl-lib::fdo (lapack::ii 1 (f2cl-lib::int-add lapack::ii 1)) ((lisp::> lapack::ii lapack::ierr) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::wr-%data% ((f2cl-lib::int-add (f2cl-lib::int-sub lapack::i lapack::ns) lapack::ii)) ((1 lisp::*)) lapack::wr-%offset%) (f2cl-lib::fref lapack::s (lapack::ii lapack::ii) ((1 lapack::lds) (1 lapack::nsmax)))) (lisp::setf (f2cl-lib::fref lapack::wi-%data% ((f2cl-lib::int-add (f2cl-lib::int-sub lapack::i lapack::ns) lapack::ii)) ((1 lisp::*)) lapack::wi-%offset%) lapack::zero) lapack::label90)))))) (lisp::setf (f2cl-lib::fref lapack::v (1) ((1 (f2cl-lib::int-add lapack::nsmax 1)))) lapack::one) (f2cl-lib::fdo (lapack::ii 2 (f2cl-lib::int-add lapack::ii 1)) ((lisp::> lapack::ii (f2cl-lib::int-add lapack::ns 1)) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::v (lapack::ii) ((1 (f2cl-lib::int-add lapack::nsmax 1)))) lapack::zero) lapack::label100)) (lisp::setf lapack::nv 1) (f2cl-lib::fdo (lapack::j (f2cl-lib::int-add lapack::i (f2cl-lib::int-sub lapack::ns) 1) (f2cl-lib::int-add lapack::j 1)) ((lisp::> lapack::j lapack::i) lisp::nil) (lisp::tagbody (lisp::cond ((lisp::>= (f2cl-lib::fref lapack::wi (lapack::j) ((1 lisp::*))) lapack::zero) (lisp::cond ((lisp::= (f2cl-lib::fref lapack::wi (lapack::j) ((1 lisp::*))) lapack::zero) (blas::dcopy (f2cl-lib::int-add lapack::nv 1) lapack::v 1 lapack::vv 1) (blas::dgemv "No transpose" (f2cl-lib::int-add lapack::nv 1) lapack::nv lapack::one (f2cl-lib::array-slice lapack::h lisp::double-float (lapack::l lapack::l) ((1 lapack::ldh) (1 lisp::*))) lapack::ldh lapack::vv 1 (lisp::- (f2cl-lib::fref lapack::wr-%data% (lapack::j) ((1 lisp::*)) lapack::wr-%offset%)) lapack::v 1) (lisp::setf lapack::nv (f2cl-lib::int-add lapack::nv 1))) ((lisp::> (f2cl-lib::fref lapack::wi (lapack::j) ((1 lisp::*))) lapack::zero) (blas::dcopy (f2cl-lib::int-add lapack::nv 1) lapack::v 1 lapack::vv 1) (blas::dgemv "No transpose" (f2cl-lib::int-add lapack::nv 1) lapack::nv lapack::one (f2cl-lib::array-slice lapack::h lisp::double-float (lapack::l lapack::l) ((1 lapack::ldh) (1 lisp::*))) lapack::ldh lapack::v 1 (lisp::* (lisp::- lapack::two) (f2cl-lib::fref lapack::wr-%data% (lapack::j) ((1 lisp::*)) lapack::wr-%offset%)) lapack::vv 1) (lisp::setf lapack::itemp (blas::idamax (f2cl-lib::int-add lapack::nv 1) lapack::vv 1)) (lisp::setf lapack::temp (lisp::/ lapack::one (lisp::max (lisp::abs (f2cl-lib::fref lapack::vv (lapack::itemp) ((1 (f2cl-lib::int-add lapack::nsmax 1))))) lapack::smlnum))) (blas::dscal (f2cl-lib::int-add lapack::nv 1) lapack::temp lapack::vv 1) (lisp::setf lapack::absw (lapack::dlapy2 (f2cl-lib::fref lapack::wr-%data% (lapack::j) ((1 lisp::*)) lapack::wr-%offset%) (f2cl-lib::fref lapack::wi-%data% (lapack::j) ((1 lisp::*)) lapack::wi-%offset%))) (lisp::setf lapack::temp (lisp::* lapack::temp lapack::absw lapack::absw)) (blas::dgemv "No transpose" (f2cl-lib::int-add lapack::nv 2) (f2cl-lib::int-add lapack::nv 1) lapack::one (f2cl-lib::array-slice lapack::h lisp::double-float (lapack::l lapack::l) ((1 lapack::ldh) (1 lisp::*))) lapack::ldh lapack::vv 1 lapack::temp lapack::v 1) (lisp::setf lapack::nv (f2cl-lib::int-add lapack::nv 2)))) (lisp::setf lapack::itemp (blas::idamax lapack::nv lapack::v 1)) (lisp::setf lapack::temp (lisp::abs (f2cl-lib::fref lapack::v (lapack::itemp) ((1 (f2cl-lib::int-add lapack::nsmax 1)))))) (lisp::cond ((lisp::= lapack::temp lapack::zero) (lisp::setf (f2cl-lib::fref lapack::v (1) ((1 (f2cl-lib::int-add lapack::nsmax 1)))) lapack::one) (f2cl-lib::fdo (lapack::ii 2 (f2cl-lib::int-add lapack::ii 1)) ((lisp::> lapack::ii lapack::nv) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::v (lapack::ii) ((1 (f2cl-lib::int-add lapack::nsmax 1)))) lapack::zero) lapack::label110))) (lisp::t (lisp::setf lapack::temp (lisp::max lapack::temp lapack::smlnum)) (blas::dscal lapack::nv (lisp::/ lapack::one lapack::temp) lapack::v 1))))) lapack::label120)) (f2cl-lib::fdo (lapack::k lapack::l (f2cl-lib::int-add lapack::k 1)) ((lisp::> lapack::k (f2cl-lib::int-add lapack::i (f2cl-lib::int-sub 1))) lisp::nil) (lisp::tagbody (lisp::setf lapack::nr (lisp::min (lisp::the f2cl-lib::integer4 (f2cl-lib::int-add lapack::ns 1)) (lisp::the f2cl-lib::integer4 (f2cl-lib::int-add (f2cl-lib::int-sub lapack::i lapack::k) 1)))) (lisp::if (lisp::> lapack::k lapack::l) (blas::dcopy lapack::nr (f2cl-lib::array-slice lapack::h lisp::double-float (lapack::k (f2cl-lib::int-sub lapack::k 1)) ((1 lapack::ldh) (1 lisp::*))) 1 lapack::v 1)) (lisp::multiple-value-bind (lapack::var-0 lapack::var-1 lapack::var-2 lapack::var-3 lapack::var-4) (lapack::dlarfg lapack::nr (f2cl-lib::fref lapack::v (1) ((1 (f2cl-lib::int-add lapack::nsmax 1)))) (f2cl-lib::array-slice lapack::v lisp::double-float (2) ((1 (f2cl-lib::int-add lapack::nsmax 1)))) 1 lapack::tau) (lisp::declare (lisp::ignore lapack::var-0 lapack::var-2 lapack::var-3)) (lisp::setf (f2cl-lib::fref lapack::v (1) ((1 (f2cl-lib::int-add lapack::nsmax 1)))) lapack::var-1) (lisp::setf lapack::tau lapack::var-4)) (lisp::cond ((lisp::> lapack::k lapack::l) (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::k (f2cl-lib::int-sub lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) (f2cl-lib::fref lapack::v (1) ((1 (f2cl-lib::int-add lapack::nsmax 1))))) (f2cl-lib::fdo (lapack::ii (f2cl-lib::int-add lapack::k 1) (f2cl-lib::int-add lapack::ii 1)) ((lisp::> lapack::ii lapack::i) lisp::nil) (lisp::tagbody (lisp::setf (f2cl-lib::fref lapack::h-%data% (lapack::ii (f2cl-lib::int-sub lapack::k 1)) ((1 lapack::ldh) (1 lisp::*)) lapack::h-%offset%) lapack::zero) lapack::label130)))) (lisp::setf (f2cl-lib::fref lapack::v (1) ((1 (f2cl-lib::int-add lapack::nsmax 1)))) lapack::one) (lapack::dlarfx "Left" lapack::nr (f2cl-lib::int-add (f2cl-lib::int-sub lapack::i2 lapack::k) 1) lapack::v lapack::tau (f2cl-lib::array-slice lapack::h lisp::double-float (lapack::k lapack::k) ((1 lapack::ldh) (1 lisp::*))) lapack::ldh lapack::work) (lapack::dlarfx "Right" (f2cl-lib::int-add (f2cl-lib::int-sub (lisp::min (lisp::the f2cl-lib::integer4 (f2cl-lib::int-add lapack::k lapack::nr)) (lisp::the f2cl-lib::integer4 lapack::i)) lapack::i1) 1) lapack::nr lapack::v lapack::tau (f2cl-lib::array-slice lapack::h lisp::double-float (lapack::i1 lapack::k) ((1 lapack::ldh) (1 lisp::*))) lapack::ldh lapack::work) (lisp::cond (lapack::wantz (lapack::dlarfx "Right" lapack::nh lapack::nr lapack::v lapack::tau (f2cl-lib::array-slice lapack::z lisp::double-float (lapack::ilo lapack::k) ((1 lapack::ldz) (1 lisp::*))) lapack::ldz lapack::work))) lapack::label140)) lapack::label150)) (lisp::setf lapack::info lapack::i) (lisp::go lapack::end_label) lapack::label160 (lisp::multiple-value-bind (lapack::var-0 lapack::var-1 lapack::var-2 lapack::var-3 lapack::var-4 lapack::var-5 lapack::var-6 lapack::var-7 lapack::var-8 lapack::var-9 lapack::var-10 lapack::var-11 lapack::var-12 lapack::var-13) (lapack::dlahqr lapack::wantt lapack::wantz lapack::n lapack::l lapack::i lapack::h lapack::ldh lapack::wr lapack::wi lapack::ilo lapack::ihi lapack::z lapack::ldz lapack::info) (lisp::declare (lisp::ignore lapack::var-0 lapack::var-1 lapack::var-2 lapack::var-3 lapack::var-4 lapack::var-5 lapack::var-6 lapack::var-7 lapack::var-8 lapack::var-9 lapack::var-10 lapack::var-11 lapack::var-12)) (lisp::setf lapack::info lapack::var-13)) (lisp::if (lisp::> lapack::info 0) (lisp::go lapack::end_label)) (lisp::setf lapack::itn (f2cl-lib::int-sub lapack::itn lapack::its)) (lisp::setf lapack::i (f2cl-lib::int-sub lapack::l 1)) (lisp::go lapack::label50) lapack::label170 (lisp::setf (f2cl-lib::fref lapack::work-%data% (1) ((1 lisp::*)) lapack::work-%offset%) (lisp::coerce (lisp::the f2cl-lib::integer4 (lisp::max (lisp::the f2cl-lib::integer4 1) (lisp::the f2cl-lib::integer4 lapack::n))) (lisp::quote lisp::double-float))) (lisp::go lapack::end_label) lapack::end_label (lisp::return (lisp::values lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lisp::nil lapack::info)))))))))
)
